{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\jospa\\\\OneDrive\\\\Desktop\\\\artesjac-test2\\\\artesjac-test2\\\\src\\\\pages\\\\ShopPage.js\",\n  _s = $RefreshSig$();\n// src/pages/ShopPage.js\nimport React, { useState, useEffect, useMemo } from \"react\";\nimport { Link, useNavigate, useLocation } from \"react-router-dom\";\nimport { useAuth } from \"../modules/auth/AuthContext\";\nimport { CartAPI } from \"../api/cart.service\";\nimport \"../styles/shop.css\";\nimport { ShopAPI } from \"../api/shop.service\";\nimport { resolveImgUrl } from \"../utils/resolveImgUrl\";\nimport noImage from \"../assets/images/noimage.png\";\n\n// ... (helpers tal como los ten√©s arriba)\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst firstImg = p => {\n  const c = Array.isArray(p === null || p === void 0 ? void 0 : p.images) && p.images.length ? p.images.find(Boolean) : (p === null || p === void 0 ? void 0 : p.image) || (p === null || p === void 0 ? void 0 : p.img) || (p === null || p === void 0 ? void 0 : p.thumbnail) || null;\n  return c ? String(c).replace(/\\\\/g, \"/\") : null;\n};\nconst normalizeCategory = cat => {\n  const c = String(cat || \"\").toLowerCase();\n  const map = {\n    jewelery: \"joyeria\",\n    jewelry: \"joyeria\",\n    art: \"pintura\",\n    paintings: \"pintura\",\n    ceramics: \"ceramica\",\n    ceramic: \"ceramica\",\n    textiles: \"textil\",\n    textile: \"textil\",\n    decoration: \"decoracion\",\n    decor: \"decoracion\",\n    bags: \"bolsos\",\n    bag: \"bolsos\",\n    wood: \"escultura\",\n    sculpture: \"escultura\",\n    esculturas: \"escultura\"\n  };\n  return map[c] || c || \"otros\";\n};\nconst categoryLabel = id => {\n  const map = {\n    todos: \"Todos los productos\",\n    textil: \"Textil\",\n    joyeria: \"Joyer√≠a\",\n    pintura: \"Pintura\",\n    ceramica: \"Cer√°mica\",\n    escultura: \"Escultura\",\n    bolsos: \"Bolsos\",\n    decoracion: \"Decoraci√≥n\",\n    otros: \"Otros\"\n  };\n  return map[id] || (id ? id[0].toUpperCase() + id.slice(1) : \"Otros\");\n};\nconst categoryIcon = id => {\n  const map = {\n    textil: \"üßµ\",\n    joyeria: \"üíé\",\n    pintura: \"üé®\",\n    ceramica: \"üè∫\",\n    escultura: \"üóø\",\n    bolsos: \"üëú\",\n    decoracion: \"üñºÔ∏è\",\n    otros: \"ü™Ñ\"\n  };\n  return map[id] || \"üé®\";\n};\nconst fmtCRC = n => typeof n === \"number\" ? `‚Ç°${n.toLocaleString(\"es-CR\")}` : String(n || \"\");\nconst getNumericPrice = p => {\n  if (typeof (p === null || p === void 0 ? void 0 : p.numericPrice) === \"number\") return p.numericPrice;\n  if (typeof (p === null || p === void 0 ? void 0 : p.price) === \"number\") return p.price;\n  if (typeof (p === null || p === void 0 ? void 0 : p.price) === \"string\") {\n    const digits = p.price.replace(/[^\\d]/g, \"\");\n    return Number(digits || 0);\n  }\n  return 0;\n};\nconst mockProducts = [/* (tu mock igual que antes) */];\nexport const ShopPage = () => {\n  _s();\n  const {\n    user,\n    token\n  } = useAuth() || {};\n  const authToken = token || localStorage.getItem(\"token\") || localStorage.getItem(\"authToken\");\n  const navigate = useNavigate();\n  const location = useLocation();\n  const [products, setProducts] = useState([]);\n  const [filteredProducts, setFilteredProducts] = useState([]);\n  const [selectedCategory, setSelectedCategory] = useState(\"todos\");\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [cartItems, setCartItems] = useState([]);\n  const [addingToCart, setAddingToCart] = useState(null);\n  const [error, setError] = useState(\"\");\n  useEffect(() => {\n    try {\n      const saved = localStorage.getItem(\"artesjac-cart\");\n      if (saved && saved !== \"null\" && saved !== \"[]\") setCartItems(JSON.parse(saved));\n    } catch {}\n  }, []);\n  useEffect(() => {\n    (async () => {\n      setError(\"\");\n      try {\n        var _res$data;\n        const res = await ShopAPI.list({\n          limit: 200\n        });\n        const list = Array.isArray(res === null || res === void 0 ? void 0 : (_res$data = res.data) === null || _res$data === void 0 ? void 0 : _res$data.data) ? res.data.data : [];\n        const normalized = list.map(p => ({\n          ...p,\n          _normalizedCategory: normalizeCategory(p.category),\n          _displayName: p.title || p.name || \"Producto\",\n          _displayPrice: fmtCRC(typeof p.price === \"number\" ? p.price : p.price)\n        }));\n        setProducts(normalized);\n      } catch (e) {\n        setError(\"No se pudieron cargar los productos. Mostrando datos de ejemplo.\");\n        const normalizedMock = mockProducts.map(p => ({\n          ...p,\n          _normalizedCategory: normalizeCategory(p.category),\n          _displayName: p.name,\n          _displayPrice: p.price\n        }));\n        setProducts(normalizedMock);\n      }\n    })();\n  }, []);\n  useEffect(() => {\n    let list = products;\n    if (selectedCategory !== \"todos\") list = list.filter(p => p._normalizedCategory === selectedCategory);\n    if (searchTerm) {\n      const s = searchTerm.toLowerCase();\n      list = list.filter(p => (p._displayName || \"\").toLowerCase().includes(s) || (p.description || \"\").toLowerCase().includes(s));\n    }\n    setFilteredProducts(list);\n  }, [selectedCategory, searchTerm, products]);\n  const categories = useMemo(() => {\n    const counts = {\n      textil: 0,\n      joyeria: 0,\n      pintura: 0,\n      ceramica: 0,\n      escultura: 0,\n      bolsos: 0,\n      decoracion: 0,\n      otros: 0\n    };\n    products.forEach(p => {\n      const key = p._normalizedCategory || \"otros\";\n      if (counts[key] !== undefined) counts[key] += 1;else counts.otros += 1;\n    });\n    const base = [\"todos\", \"textil\", \"joyeria\", \"pintura\", \"ceramica\", \"escultura\", \"bolsos\", \"decoracion\", \"otros\"];\n    return base.map(id => ({\n      id,\n      name: categoryLabel(id),\n      count: id === \"todos\" ? products.length : counts[id],\n      icon: categoryIcon(id)\n    }));\n  }, [products]);\n  const getImgSrc = p => {\n    const c = firstImg(p);\n    if (!c) return noImage;\n    try {\n      return resolveImgUrl(c) || noImage;\n    } catch {\n      return noImage;\n    }\n  };\n\n  // üöÄ Server-first\n  const addToCart = async product => {\n    const itemId = product._id || product.id || product.slug;\n    setAddingToCart(itemId);\n    if (!authToken) {\n      const next = encodeURIComponent(`${location.pathname}${location.search || \"\"}`);\n      setAddingToCart(null);\n      return navigate(`/login?next=${next}`);\n    }\n    try {\n      await CartAPI.add({\n        productId: itemId,\n        quantity: 1\n      }, authToken);\n      // Opcional: mantener indicador local para el banner superior\n      const saved = localStorage.getItem(\"artesjac-cart\");\n      let current = saved && saved !== \"null\" ? JSON.parse(saved) : [];\n      const idx = current.findIndex(it => it.id === itemId);\n      if (idx > -1) current[idx].quantity = (current[idx].quantity || 1) + 1;else current.push({\n        id: itemId,\n        quantity: 1,\n        numericPrice: getNumericPrice(product),\n        name: product._displayName,\n        category: product._normalizedCategory\n      });\n      localStorage.setItem(\"artesjac-cart\", JSON.stringify(current));\n      setCartItems(current);\n\n      // mini notificaci√≥n (sin cambiar tu UI)\n      await new Promise(r => setTimeout(r, 500));\n      const n = document.createElement(\"div\");\n      n.style.cssText = `position:fixed;top:20px;right:20px;background:linear-gradient(135deg,#4caf50,#45a049);color:#fff;padding:1rem 1.5rem;border-radius:8px;box-shadow:0 4px 15px rgba(76,175,80,.3);z-index:1000;font-weight:bold;animation:slideIn .3s ease;`;\n      n.innerHTML = `‚úÖ ${product._displayName} agregado al carrito`;\n      document.body.appendChild(n);\n      setTimeout(() => n.remove(), 3000);\n    } catch (e) {\n      alert(\"No se pudo agregar al carrito\");\n    } finally {\n      setAddingToCart(null);\n    }\n  };\n  const calculateCartTotal = () => cartItems.reduce((t, it) => t + Number(it.numericPrice || 0) * Number(it.quantity || 0), 0);\n  const getTotalCartItems = () => cartItems.reduce((t, it) => t + Number(it.quantity || 0), 0);\n  return /*#__PURE__*/_jsxDEV(\"main\", {\n    className: \"shop-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"shop-header\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"Tienda ArtesJAC\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Descubre arte aut\\xE9ntico costarricense hecho a mano por talentosos artesanos locales\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"cart-indicator\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"cart-indicator-info\",\n        children: [/*#__PURE__*/_jsxDEV(\"i\", {\n          className: \"fa fa-shopping-cart\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 139,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: [getTotalCartItems(), \" producto\", getTotalCartItems() !== 1 ? \"s\" : \"\", \" en el carrito - Total: \", fmtCRC(calculateCartTotal())]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 140,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Link, {\n        to: \"/cart\",\n        className: \"view-cart-btn\",\n        children: [/*#__PURE__*/_jsxDEV(\"i\", {\n          className: \"fa fa-arrow-right\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 145,\n          columnNumber: 21\n        }, this), \" Ver Carrito\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 144,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n      className: \"products-section\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"products-grid\",\n        children: filteredProducts.map(p => {\n          const key = p.slug || p._id || p.id;\n          const href = p.slug ? `/p/${p.slug}` : `/product/${p.id}`;\n          const name = p._displayName;\n          const price = fmtCRC(typeof p.price === \"number\" ? p.price : p.price);\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"product-card\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"product-media\",\n              children: /*#__PURE__*/_jsxDEV(\"img\", {\n                src: getImgSrc(p),\n                alt: `Imagen de ${name}`,\n                className: \"product-thumb\",\n                loading: \"lazy\",\n                decoding: \"async\",\n                referrerPolicy: \"no-referrer\",\n                crossOrigin: \"anonymous\",\n                onError: e => {\n                  if (e.currentTarget.dataset.fallback === \"1\") return;\n                  e.currentTarget.dataset.fallback = \"1\";\n                  e.currentTarget.src = noImage;\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 162,\n                columnNumber: 37\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 161,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"product-info\",\n              children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                className: \"product-name\",\n                children: name\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 169,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"product-price\",\n                children: price\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 170,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"product-category\",\n                children: [categoryIcon(p._normalizedCategory), \" \", categoryLabel(p._normalizedCategory)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 171,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 168,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"product-actions\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"btn-add-to-cart\",\n                onClick: () => addToCart(p),\n                disabled: addingToCart === (p._id || p.id || p.slug),\n                children: addingToCart === (p._id || p.id || p.slug) ? /*#__PURE__*/_jsxDEV(_Fragment, {\n                  children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                    className: \"fa fa-spinner fa-spin\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 175,\n                    columnNumber: 90\n                  }, this), \" Agregando...\"]\n                }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n                  children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                    className: \"fa fa-shopping-cart\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 175,\n                    columnNumber: 154\n                  }, this), \" Agregar al carrito\"]\n                }, void 0, true)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 174,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(Link, {\n                to: href,\n                className: \"btn-view-details\",\n                style: {\n                  textDecoration: \"none\"\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"fa fa-eye\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 178,\n                  columnNumber: 41\n                }, this), \" Ver detalles\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 177,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 173,\n              columnNumber: 33\n            }, this)]\n          }, key, true, {\n            fileName: _jsxFileName,\n            lineNumber: 160,\n            columnNumber: 29\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 153,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"style\", {\n      jsx: true,\n      children: `\n        @keyframes slideIn { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }\n      `\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 126,\n    columnNumber: 9\n  }, this);\n};\n_s(ShopPage, \"COnZGXj6ETxLsgMFD/ug+k+JnTo=\", false, function () {\n  return [useAuth, useNavigate, useLocation];\n});\n_c = ShopPage;\nvar _c;\n$RefreshReg$(_c, \"ShopPage\");","map":{"version":3,"names":["React","useState","useEffect","useMemo","Link","useNavigate","useLocation","useAuth","CartAPI","ShopAPI","resolveImgUrl","noImage","jsxDEV","_jsxDEV","Fragment","_Fragment","firstImg","p","c","Array","isArray","images","length","find","Boolean","image","img","thumbnail","String","replace","normalizeCategory","cat","toLowerCase","map","jewelery","jewelry","art","paintings","ceramics","ceramic","textiles","textile","decoration","decor","bags","bag","wood","sculpture","esculturas","categoryLabel","id","todos","textil","joyeria","pintura","ceramica","escultura","bolsos","decoracion","otros","toUpperCase","slice","categoryIcon","fmtCRC","n","toLocaleString","getNumericPrice","numericPrice","price","digits","Number","mockProducts","ShopPage","_s","user","token","authToken","localStorage","getItem","navigate","location","products","setProducts","filteredProducts","setFilteredProducts","selectedCategory","setSelectedCategory","searchTerm","setSearchTerm","cartItems","setCartItems","addingToCart","setAddingToCart","error","setError","saved","JSON","parse","_res$data","res","list","limit","data","normalized","_normalizedCategory","category","_displayName","title","name","_displayPrice","e","normalizedMock","filter","s","includes","description","categories","counts","forEach","key","undefined","base","count","icon","getImgSrc","addToCart","product","itemId","_id","slug","next","encodeURIComponent","pathname","search","add","productId","quantity","current","idx","findIndex","it","push","setItem","stringify","Promise","r","setTimeout","document","createElement","style","cssText","innerHTML","body","appendChild","remove","alert","calculateCartTotal","reduce","t","getTotalCartItems","className","children","fileName","_jsxFileName","lineNumber","columnNumber","to","href","src","alt","loading","decoding","referrerPolicy","crossOrigin","onError","currentTarget","dataset","fallback","onClick","disabled","textDecoration","jsx","_c","$RefreshReg$"],"sources":["C:/Users/jospa/OneDrive/Desktop/artesjac-test2/artesjac-test2/src/pages/ShopPage.js"],"sourcesContent":["// src/pages/ShopPage.js\r\nimport React, { useState, useEffect, useMemo } from \"react\";\r\nimport { Link, useNavigate, useLocation } from \"react-router-dom\";\r\nimport { useAuth } from \"../modules/auth/AuthContext\";\r\nimport { CartAPI } from \"../api/cart.service\";\r\nimport \"../styles/shop.css\";\r\nimport { ShopAPI } from \"../api/shop.service\";\r\nimport { resolveImgUrl } from \"../utils/resolveImgUrl\";\r\nimport noImage from \"../assets/images/noimage.png\";\r\n\r\n// ... (helpers tal como los ten√©s arriba)\r\nconst firstImg = (p) => { const c = Array.isArray(p?.images) && p.images.length ? p.images.find(Boolean) : p?.image || p?.img || p?.thumbnail || null; return c ? String(c).replace(/\\\\/g, \"/\") : null; };\r\nconst normalizeCategory = (cat) => { const c = String(cat || \"\").toLowerCase(); const map = { jewelery: \"joyeria\", jewelry: \"joyeria\", art: \"pintura\", paintings: \"pintura\", ceramics: \"ceramica\", ceramic: \"ceramica\", textiles: \"textil\", textile: \"textil\", decoration: \"decoracion\", decor: \"decoracion\", bags: \"bolsos\", bag: \"bolsos\", wood: \"escultura\", sculpture: \"escultura\", esculturas: \"escultura\" }; return map[c] || c || \"otros\"; };\r\nconst categoryLabel = (id) => { const map = { todos: \"Todos los productos\", textil: \"Textil\", joyeria: \"Joyer√≠a\", pintura: \"Pintura\", ceramica: \"Cer√°mica\", escultura: \"Escultura\", bolsos: \"Bolsos\", decoracion: \"Decoraci√≥n\", otros: \"Otros\" }; return map[id] || (id ? id[0].toUpperCase() + id.slice(1) : \"Otros\"); };\r\nconst categoryIcon = (id) => { const map = { textil: \"üßµ\", joyeria: \"üíé\", pintura: \"üé®\", ceramica: \"üè∫\", escultura: \"üóø\", bolsos: \"üëú\", decoracion: \"üñºÔ∏è\", otros: \"ü™Ñ\" }; return map[id] || \"üé®\"; };\r\nconst fmtCRC = (n) => typeof n === \"number\" ? `‚Ç°${n.toLocaleString(\"es-CR\")}` : String(n || \"\");\r\nconst getNumericPrice = (p) => { if (typeof p?.numericPrice === \"number\") return p.numericPrice; if (typeof p?.price === \"number\") return p.price; if (typeof p?.price === \"string\") { const digits = p.price.replace(/[^\\d]/g, \"\"); return Number(digits || 0); } return 0; };\r\n\r\nconst mockProducts = [/* (tu mock igual que antes) */];\r\n\r\nexport const ShopPage = () => {\r\n    const { user, token } = useAuth() || {};\r\n    const authToken = token || localStorage.getItem(\"token\") || localStorage.getItem(\"authToken\");\r\n    const navigate = useNavigate();\r\n    const location = useLocation();\r\n\r\n    const [products, setProducts] = useState([]);\r\n    const [filteredProducts, setFilteredProducts] = useState([]);\r\n    const [selectedCategory, setSelectedCategory] = useState(\"todos\");\r\n    const [searchTerm, setSearchTerm] = useState(\"\");\r\n    const [cartItems, setCartItems] = useState([]);\r\n    const [addingToCart, setAddingToCart] = useState(null);\r\n    const [error, setError] = useState(\"\");\r\n\r\n    useEffect(() => {\r\n        try {\r\n            const saved = localStorage.getItem(\"artesjac-cart\");\r\n            if (saved && saved !== \"null\" && saved !== \"[]\") setCartItems(JSON.parse(saved));\r\n        } catch { }\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        (async () => {\r\n            setError(\"\");\r\n            try {\r\n                const res = await ShopAPI.list({ limit: 200 });\r\n                const list = Array.isArray(res?.data?.data) ? res.data.data : [];\r\n                const normalized = list.map((p) => ({\r\n                    ...p,\r\n                    _normalizedCategory: normalizeCategory(p.category),\r\n                    _displayName: p.title || p.name || \"Producto\",\r\n                    _displayPrice: fmtCRC(typeof p.price === \"number\" ? p.price : p.price),\r\n                }));\r\n                setProducts(normalized);\r\n            } catch (e) {\r\n                setError(\"No se pudieron cargar los productos. Mostrando datos de ejemplo.\");\r\n                const normalizedMock = mockProducts.map((p) => ({\r\n                    ...p,\r\n                    _normalizedCategory: normalizeCategory(p.category),\r\n                    _displayName: p.name,\r\n                    _displayPrice: p.price,\r\n                }));\r\n                setProducts(normalizedMock);\r\n            }\r\n        })();\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        let list = products;\r\n        if (selectedCategory !== \"todos\") list = list.filter((p) => p._normalizedCategory === selectedCategory);\r\n        if (searchTerm) {\r\n            const s = searchTerm.toLowerCase();\r\n            list = list.filter((p) => (p._displayName || \"\").toLowerCase().includes(s) || (p.description || \"\").toLowerCase().includes(s));\r\n        }\r\n        setFilteredProducts(list);\r\n    }, [selectedCategory, searchTerm, products]);\r\n\r\n    const categories = useMemo(() => {\r\n        const counts = { textil: 0, joyeria: 0, pintura: 0, ceramica: 0, escultura: 0, bolsos: 0, decoracion: 0, otros: 0 };\r\n        products.forEach((p) => { const key = p._normalizedCategory || \"otros\"; if (counts[key] !== undefined) counts[key] += 1; else counts.otros += 1; });\r\n        const base = [\"todos\", \"textil\", \"joyeria\", \"pintura\", \"ceramica\", \"escultura\", \"bolsos\", \"decoracion\", \"otros\"];\r\n        return base.map((id) => ({ id, name: categoryLabel(id), count: id === \"todos\" ? products.length : counts[id], icon: categoryIcon(id) }));\r\n    }, [products]);\r\n\r\n    const getImgSrc = (p) => { const c = firstImg(p); if (!c) return noImage; try { return resolveImgUrl(c) || noImage; } catch { return noImage; } };\r\n\r\n    // üöÄ Server-first\r\n    const addToCart = async (product) => {\r\n        const itemId = product._id || product.id || product.slug;\r\n        setAddingToCart(itemId);\r\n\r\n        if (!authToken) {\r\n            const next = encodeURIComponent(`${location.pathname}${location.search || \"\"}`);\r\n            setAddingToCart(null);\r\n            return navigate(`/login?next=${next}`);\r\n        }\r\n\r\n        try {\r\n            await CartAPI.add({ productId: itemId, quantity: 1 }, authToken);\r\n            // Opcional: mantener indicador local para el banner superior\r\n            const saved = localStorage.getItem(\"artesjac-cart\");\r\n            let current = saved && saved !== \"null\" ? JSON.parse(saved) : [];\r\n            const idx = current.findIndex((it) => it.id === itemId);\r\n            if (idx > -1) current[idx].quantity = (current[idx].quantity || 1) + 1;\r\n            else current.push({ id: itemId, quantity: 1, numericPrice: getNumericPrice(product), name: product._displayName, category: product._normalizedCategory });\r\n            localStorage.setItem(\"artesjac-cart\", JSON.stringify(current));\r\n            setCartItems(current);\r\n\r\n            // mini notificaci√≥n (sin cambiar tu UI)\r\n            await new Promise((r) => setTimeout(r, 500));\r\n            const n = document.createElement(\"div\");\r\n            n.style.cssText = `position:fixed;top:20px;right:20px;background:linear-gradient(135deg,#4caf50,#45a049);color:#fff;padding:1rem 1.5rem;border-radius:8px;box-shadow:0 4px 15px rgba(76,175,80,.3);z-index:1000;font-weight:bold;animation:slideIn .3s ease;`;\r\n            n.innerHTML = `‚úÖ ${product._displayName} agregado al carrito`;\r\n            document.body.appendChild(n); setTimeout(() => n.remove(), 3000);\r\n        } catch (e) {\r\n            alert(\"No se pudo agregar al carrito\");\r\n        } finally {\r\n            setAddingToCart(null);\r\n        }\r\n    };\r\n\r\n    const calculateCartTotal = () => cartItems.reduce((t, it) => t + Number(it.numericPrice || 0) * Number(it.quantity || 0), 0);\r\n    const getTotalCartItems = () => cartItems.reduce((t, it) => t + Number(it.quantity || 0), 0);\r\n\r\n    return (\r\n        <main className=\"shop-container\">\r\n            {/* ‚Ä¶todo tu markup original (sin cambios visuales)‚Ä¶ */}\r\n            {/* Solo cambiamos la l√≥gica de addToCart (arriba) */}\r\n            {/* El resto de tu archivo se mantiene igual */}\r\n            {/* --- Te dejo el grid con el bot√≥n usando addToCart(product) --- */}\r\n\r\n            <div className=\"shop-header\">\r\n                <h1>Tienda ArtesJAC</h1>\r\n                <p>Descubre arte aut√©ntico costarricense hecho a mano por talentosos artesanos locales</p>\r\n            </div>\r\n\r\n            <div className=\"cart-indicator\">\r\n                <div className=\"cart-indicator-info\">\r\n                    <i className=\"fa fa-shopping-cart\"></i>\r\n                    <span>\r\n                        {getTotalCartItems()} producto{getTotalCartItems() !== 1 ? \"s\" : \"\"} en el carrito - Total: {fmtCRC(calculateCartTotal())}\r\n                    </span>\r\n                </div>\r\n                <Link to=\"/cart\" className=\"view-cart-btn\">\r\n                    <i className=\"fa fa-arrow-right\"></i> Ver Carrito\r\n                </Link>\r\n            </div>\r\n\r\n            {/* ‚Ä¶buscador, sidebar, etc‚Ä¶ */}\r\n\r\n            <section className=\"products-section\">\r\n                {/* header y mensajes‚Ä¶ */}\r\n                <div className=\"products-grid\">\r\n                    {filteredProducts.map((p) => {\r\n                        const key = p.slug || p._id || p.id;\r\n                        const href = p.slug ? `/p/${p.slug}` : `/product/${p.id}`;\r\n                        const name = p._displayName;\r\n                        const price = fmtCRC(typeof p.price === \"number\" ? p.price : p.price);\r\n                        return (\r\n                            <div key={key} className=\"product-card\">\r\n                                <div className=\"product-media\">\r\n                                    <img\r\n                                        src={getImgSrc(p)} alt={`Imagen de ${name}`} className=\"product-thumb\"\r\n                                        loading=\"lazy\" decoding=\"async\" referrerPolicy=\"no-referrer\" crossOrigin=\"anonymous\"\r\n                                        onError={(e) => { if (e.currentTarget.dataset.fallback === \"1\") return; e.currentTarget.dataset.fallback = \"1\"; e.currentTarget.src = noImage; }}\r\n                                    />\r\n                                </div>\r\n                                <div className=\"product-info\">\r\n                                    <h3 className=\"product-name\">{name}</h3>\r\n                                    <p className=\"product-price\">{price}</p>\r\n                                    <p className=\"product-category\">{categoryIcon(p._normalizedCategory)} {categoryLabel(p._normalizedCategory)}</p>\r\n                                </div>\r\n                                <div className=\"product-actions\">\r\n                                    <button className=\"btn-add-to-cart\" onClick={() => addToCart(p)} disabled={addingToCart === (p._id || p.id || p.slug)}>\r\n                                        {addingToCart === (p._id || p.id || p.slug) ? (<><i className=\"fa fa-spinner fa-spin\"></i> Agregando...</>) : (<><i className=\"fa fa-shopping-cart\"></i> Agregar al carrito</>)}\r\n                                    </button>\r\n                                    <Link to={href} className=\"btn-view-details\" style={{ textDecoration: \"none\" }}>\r\n                                        <i className=\"fa fa-eye\"></i> Ver detalles\r\n                                    </Link>\r\n                                </div>\r\n                            </div>\r\n                        );\r\n                    })}\r\n                </div>\r\n            </section>\r\n\r\n            <style jsx>{`\r\n        @keyframes slideIn { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }\r\n      `}</style>\r\n        </main>\r\n    );\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}