{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\adria\\\\Desktop\\\\artesjac-test2\\\\artesjac-test2\\\\src\\\\pages\\\\ProductPage.js\",\n  _s = $RefreshSig$();\n// src/pages/ProductPage.js\nimport React, { useState, useEffect } from \"react\";\nimport { useParams, Link, useNavigate, useLocation } from \"react-router-dom\";\nimport { useAuth } from \"../modules/auth/AuthContext\";\nimport { ShopAPI } from \"../api/shop.service\";\nimport { ReviewsAPI } from \"../api/reviews.service\";\nimport { resolveImgUrl } from \"../utils/resolveImgUrl\";\nimport noImage from \"../assets/images/noimage.png\";\nimport \"../styles/product.css\";\nimport { CartAPI } from \"../api/cart.service\";\n\n// Formateo de colones CR\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst fmtCRC = n => typeof n === \"number\" ? `₡${n.toLocaleString(\"es-CR\")}` : n;\n\n// Traducción simple de categorías (si en DB están en inglés)\nconst catLabel = c => {\n  const map = {\n    jewelery: \"Joyería\",\n    art: \"Pintura\",\n    ceramics: \"Cerámica\",\n    textiles: \"Textil\",\n    decoration: \"Decoración\",\n    bags: \"Bolsos\",\n    wood: \"Madera\"\n  };\n  return map[c] || (c ? c[0].toUpperCase() + c.slice(1) : \"General\");\n};\n\n// Saca la primera imagen válida del arreglo (se usa para carrito)\nconst firstImg = p => {\n  const arr = Array.isArray(p === null || p === void 0 ? void 0 : p.images) ? p.images : [];\n  const candidate = arr.find(Boolean);\n  return candidate ? String(candidate).replace(/\\\\/g, \"/\") : null;\n};\nconst isObjectId = s => /^[a-f\\d]{24}$/i.test(String(s || \"\"));\nexport const ProductPage = () => {\n  _s();\n  // Soporta ruta /p/:slug o /product/:id (cualquiera de los dos)\n  const params = useParams();\n  const slugOrId = params.slug || params.id;\n  const navigate = useNavigate();\n  const routerLocation = useLocation(); // ✅ usar routerLocation, no el global \"location\"\n  const {\n    user,\n    token\n  } = useAuth() || {};\n  const authToken = token || localStorage.getItem(\"token\") || localStorage.getItem(\"authToken\");\n  const [product, setProduct] = useState(null);\n  const [sellerInfo, setSellerInfo] = useState(null);\n  const [quantity, setQuantity] = useState(1);\n  const [addedToCart, setAddedToCart] = useState(false);\n\n  // --- Reviews del PRODUCTO ---\n  const [productReviews, setProductReviews] = useState([]);\n  const [averageRating, setAverageRating] = useState(0);\n  const [userRating, setUserRating] = useState(0);\n  const [reviewComment, setReviewComment] = useState(\"\");\n  const [showReviewForm, setShowReviewForm] = useState(false);\n\n  // --- Reviews de la TIENDA ---\n  const [storeReviews, setStoreReviews] = useState([]);\n  const [storeAvg, setStoreAvg] = useState(0);\n  const [storeUserRating, setStoreUserRating] = useState(0);\n  const [storeReviewComment, setStoreReviewComment] = useState(\"\");\n  const [showStoreReviewForm, setShowStoreReviewForm] = useState(false);\n  const renderStars = (rating, interactive = false, onStarClick = null) => /*#__PURE__*/_jsxDEV(\"div\", {\n    className: `stars ${interactive ? \"interactive\" : \"\"}`,\n    children: [1, 2, 3, 4, 5].map(star => /*#__PURE__*/_jsxDEV(\"i\", {\n      className: `fa fa-star ${star <= Math.round(rating) ? \"active\" : \"\"}`,\n      onClick: interactive ? () => onStarClick(star) : undefined\n    }, star, false, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 17\n    }, this))\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 69,\n    columnNumber: 9\n  }, this);\n\n  // Cargar detalle + reseñas desde DB\n  const load = async () => {\n    try {\n      var _resDetail$data;\n      // Detalle por slugOrId\n      const resDetail = await ShopAPI.get(slugOrId);\n      const detail = resDetail === null || resDetail === void 0 ? void 0 : (_resDetail$data = resDetail.data) === null || _resDetail$data === void 0 ? void 0 : _resDetail$data.data;\n      if (!detail) {\n        setProduct(null);\n        return;\n      }\n      setProduct(detail);\n\n      // Vendedor\n      if (detail.vendorId) {\n        const vendorId = detail.vendorId._id || detail.vendorId.id || detail.vendorId;\n        setSellerInfo({\n          id: vendorId,\n          businessName: detail.vendorId.companyName || detail.vendorId.name,\n          name: detail.vendorId.name,\n          role: detail.vendorId.role,\n          avatar: detail.vendorId.avatar\n        });\n      } else {\n        setSellerInfo(null);\n      }\n\n      // PRODUCT REVIEWS (DB)\n      const pid = detail._id || detail.id;\n      if (pid) {\n        var _resReviews$data;\n        const resReviews = await ReviewsAPI.listProduct(pid, {\n          page: 1,\n          limit: 50\n        });\n        const list = (resReviews === null || resReviews === void 0 ? void 0 : (_resReviews$data = resReviews.data) === null || _resReviews$data === void 0 ? void 0 : _resReviews$data.data) || [];\n        setProductReviews(list);\n        const avg = list.reduce((acc, rv) => acc + (rv.rating || 0), 0) / (list.length || 1);\n        setAverageRating(list.length ? avg : 0);\n\n        // Si el usuario ya reseñó este producto, precarga para editar\n        const mine = user && list.find(r => {\n          var _r$userId;\n          return String(((_r$userId = r.userId) === null || _r$userId === void 0 ? void 0 : _r$userId._id) || r.userId) === String(user.id);\n        });\n        if (mine) {\n          setUserRating(mine.rating);\n          setReviewComment(mine.comment || \"\");\n        }\n      } else {\n        setProductReviews([]);\n        setAverageRating(0);\n      }\n\n      // STORE REVIEWS (DB)\n      const vid = detail.vendorId && (detail.vendorId._id || detail.vendorId.id || detail.vendorId);\n      if (vid && isObjectId(vid)) {\n        var _r2$data;\n        const r2 = await ReviewsAPI.listStore(vid, {\n          page: 1,\n          limit: 50\n        });\n        const list2 = (r2 === null || r2 === void 0 ? void 0 : (_r2$data = r2.data) === null || _r2$data === void 0 ? void 0 : _r2$data.data) || [];\n        setStoreReviews(list2);\n        const avg2 = list2.reduce((a, b) => a + (b.rating || 0), 0) / (list2.length || 1);\n        setStoreAvg(list2.length ? avg2 : 0);\n        const mine2 = user && list2.find(r => {\n          var _r$userId2;\n          return String(((_r$userId2 = r.userId) === null || _r$userId2 === void 0 ? void 0 : _r$userId2._id) || r.userId) === String(user.id);\n        });\n        if (mine2) {\n          setStoreUserRating(mine2.rating);\n          setStoreReviewComment(mine2.comment || \"\");\n        }\n      } else {\n        setStoreReviews([]);\n        setStoreAvg(0);\n      }\n    } catch (err) {\n      var _err$response;\n      console.error(\"Product detail error:\", (err === null || err === void 0 ? void 0 : (_err$response = err.response) === null || _err$response === void 0 ? void 0 : _err$response.data) || err.message);\n      setProduct(null);\n    }\n  };\n  useEffect(() => {\n    load();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [slugOrId]);\n\n  // ✅ URL de imagen robusta con fallbacks\n  const imgSrc = React.useMemo(() => {\n    if (!product) return noImage;\n    const raw = Array.isArray(product === null || product === void 0 ? void 0 : product.images) && product.images.length ? product.images.find(Boolean) : (product === null || product === void 0 ? void 0 : product.image) || (product === null || product === void 0 ? void 0 : product.img) || (product === null || product === void 0 ? void 0 : product.thumbnail) || null;\n    if (!raw) return noImage;\n    const normalized = String(raw).replace(/\\\\/g, \"/\");\n    try {\n      const resolved = resolveImgUrl(normalized);\n      return resolved || normalized || noImage;\n    } catch {\n      return normalized || noImage;\n    }\n  }, [product]);\n\n  // === Agregar al carrito (server-first) ===\n  const handleAddToCart = async () => {\n    if (!product) return;\n    const id = product._id || product.id || null;\n    const ref = product.slug || product.id || id;\n    try {\n      await CartAPI.add({\n        productId: id,\n        productRef: ref,\n        quantity\n      });\n      setAddedToCart(true);\n      setTimeout(() => setAddedToCart(false), 2000);\n    } catch (e) {\n      var _e$response, _e$response2, _e$response2$data;\n      const status = e === null || e === void 0 ? void 0 : (_e$response = e.response) === null || _e$response === void 0 ? void 0 : _e$response.status;\n      if (status === 401 || status === 403) {\n        const next = encodeURIComponent(`${routerLocation.pathname}${routerLocation.search || \"\"}`);\n        return navigate(`/login?next=${next}`);\n      }\n      alert((e === null || e === void 0 ? void 0 : (_e$response2 = e.response) === null || _e$response2 === void 0 ? void 0 : (_e$response2$data = _e$response2.data) === null || _e$response2$data === void 0 ? void 0 : _e$response2$data.error) || \"No se pudo guardar en tu carrito\");\n    }\n  };\n\n  // === Enviar/actualizar RESEÑA de PRODUCTO (1 por comprador) ===\n  const handleSubmitReview = async () => {\n    if (!user || user.userType !== \"buyer\" || !product || userRating === 0) return;\n    try {\n      const pid = product._id || product.id;\n      await ReviewsAPI.upsertProduct({\n        productId: pid,\n        rating: userRating,\n        comment: reviewComment\n      }, authToken);\n      await load();\n      setShowReviewForm(false);\n      alert(\"¡Reseña del producto guardada!\");\n    } catch (error) {\n      var _error$response, _error$response$data;\n      console.error(\"Error al guardar reseña:\", error);\n      alert((error === null || error === void 0 ? void 0 : (_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.error) || \"Error al enviar la reseña\");\n    }\n  };\n\n  // === Enviar/actualizar RESEÑA de TIENDA (1 por comprador) ===\n  const handleSubmitStoreReview = async () => {\n    if (!user || user.userType !== \"buyer\" || !sellerInfo || storeUserRating === 0) return;\n    try {\n      await ReviewsAPI.upsertStore({\n        vendorId: sellerInfo.id,\n        rating: storeUserRating,\n        comment: storeReviewComment\n      }, authToken);\n      await load();\n      setShowStoreReviewForm(false);\n      alert(\"¡Reseña de la tienda guardada!\");\n    } catch (error) {\n      var _error$response2, _error$response2$data;\n      console.error(\"Error al guardar reseña tienda:\", error);\n      alert((error === null || error === void 0 ? void 0 : (_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : (_error$response2$data = _error$response2.data) === null || _error$response2$data === void 0 ? void 0 : _error$response2$data.error) || \"Error al enviar la reseña\");\n    }\n  };\n\n  // En esta versión ya NO se usa localStorage para reseñas\n  const mergedReviews = productReviews;\n  if (!product) {\n    return /*#__PURE__*/_jsxDEV(\"main\", {\n      className: \"product-container\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"product-not-found\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \"Producto no encontrado\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 235,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"El producto que buscas no existe o ha sido removido.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 236,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Link, {\n          to: \"/shop\",\n          className: \"btn-back-shop\",\n          children: \"Volver a la tienda\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 237,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 234,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 233,\n      columnNumber: 13\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"main\", {\n    className: \"product-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"nav\", {\n      className: \"breadcrumb\",\n      children: [/*#__PURE__*/_jsxDEV(Link, {\n        to: \"/\",\n        children: \"Inicio\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 249,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        children: \"/\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 250,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Link, {\n        to: \"/shop\",\n        children: \"Tienda\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 251,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        children: \"/\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 252,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"current\",\n        children: product.title\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 253,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 248,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"product-detail\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"product-image-section\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"product-image-main\",\n          children: /*#__PURE__*/_jsxDEV(\"img\", {\n            className: \"product-image-sim large\",\n            src: imgSrc,\n            alt: product.title,\n            loading: \"lazy\",\n            decoding: \"async\",\n            referrerPolicy: \"no-referrer\",\n            crossOrigin: \"anonymous\",\n            onError: e => {\n              e.currentTarget.onerror = null;\n              e.currentTarget.src = noImage;\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 260,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 259,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 258,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"product-info-section\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"product-category\",\n          children: catLabel(product.category)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 278,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n          className: \"product-title\",\n          children: product.title\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 280,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"product-rating\",\n          children: [renderStars(averageRating), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"rating-text\",\n            children: [averageRating > 0 ? averageRating.toFixed(1) : \"Sin calificar\", productReviews.length ? ` (${productReviews.length} reseñas)` : \"\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 285,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 283,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"product-price-main\",\n          children: fmtCRC(product.price)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 291,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"product-description\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"Descripci\\xF3n\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 294,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: product.description || \"Sin descripción\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 295,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 293,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"product-purchase\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"quantity-section\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Cantidad:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 300,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"quantity-controls\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => setQuantity(Math.max(1, quantity - 1)),\n                className: \"quantity-btn\",\n                children: /*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"fa fa-minus\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 303,\n                  columnNumber: 37\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 302,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"quantity-display\",\n                children: quantity\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 305,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => setQuantity(quantity + 1),\n                className: \"quantity-btn\",\n                children: /*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"fa fa-plus\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 307,\n                  columnNumber: 37\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 306,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 301,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 299,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"purchase-actions\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              className: `btn-add-to-cart ${addedToCart ? \"added\" : \"\"}`,\n              onClick: handleAddToCart,\n              disabled: product.stock <= 0,\n              children: addedToCart ? /*#__PURE__*/_jsxDEV(_Fragment, {\n                children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"fa fa-check\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 320,\n                  columnNumber: 41\n                }, this), \" \\xA1Agregado!\"]\n              }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n                children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"fa fa-shopping-cart\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 324,\n                  columnNumber: 41\n                }, this), \" Agregar al carrito\"]\n              }, void 0, true)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 313,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"btn-buy-now\",\n              disabled: product.stock <= 0,\n              onClick: () => {\n                handleAddToCart();\n                setTimeout(() => navigate(\"/cart\"), 400);\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                className: \"fa fa-bolt\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 337,\n                columnNumber: 33\n              }, this), \" Comprar ahora\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 329,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 312,\n            columnNumber: 25\n          }, this), user && user.userType === \"buyer\" && /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn-review-product\",\n            onClick: () => setShowReviewForm(true),\n            children: [/*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"fa fa-star\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 344,\n              columnNumber: 33\n            }, this), \" Evaluar Producto\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 343,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 298,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"product-features\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"feature\",\n            children: [/*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"fa fa-truck\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 351,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Env\\xEDo a todo Costa Rica\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 352,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 350,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"feature\",\n            children: [/*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"fa fa-shield-alt\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 355,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Garant\\xEDa de calidad artesanal\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 356,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 354,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"feature\",\n            children: [/*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"fa fa-heart\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 359,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Hecho con amor por artesanos locales\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 360,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 358,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 349,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 277,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 256,\n      columnNumber: 13\n    }, this), sellerInfo && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"seller-info-section\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"\\uD83C\\uDFEA Informaci\\xF3n del Vendedor\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 369,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"seller-card\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"seller-header\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"seller-avatar\",\n            children: sellerInfo.avatar ? /*#__PURE__*/_jsxDEV(\"img\", {\n              src: sellerInfo.avatar,\n              alt: sellerInfo.businessName || sellerInfo.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 374,\n              columnNumber: 37\n            }, this) : /*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"fa fa-store\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 376,\n              columnNumber: 37\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 372,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"seller-details\",\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              children: sellerInfo.businessName || sellerInfo.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 380,\n              columnNumber: 33\n            }, this), sellerInfo.role && /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"seller-category\",\n              children: String(sellerInfo.role).toUpperCase()\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 381,\n              columnNumber: 53\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 379,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 371,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"seller-actions\",\n          children: [/*#__PURE__*/_jsxDEV(Link, {\n            to: `/seller-profile/${sellerInfo.id || product.vendorId}`,\n            className: \"btn-view-store\",\n            children: [/*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"fa fa-eye\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 388,\n              columnNumber: 33\n            }, this), \" Ver Tienda Completa\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 387,\n            columnNumber: 29\n          }, this), user && user.userType === \"buyer\" && isObjectId(sellerInfo.id) && /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setShowStoreReviewForm(true),\n            className: \"btn-review-product\",\n            style: {\n              marginLeft: 8\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"fa fa-star\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 394,\n              columnNumber: 37\n            }, this), \" Evaluar Tienda\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 393,\n            columnNumber: 33\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 385,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 370,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 368,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"product-reviews-section\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"\\u2B50 Rese\\xF1as del Producto\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 404,\n        columnNumber: 17\n      }, this), mergedReviews.length > 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"reviews-list\",\n        children: mergedReviews.slice(0, 10).map(review => {\n          var _review$userId, _review$userId2, _review$userId3;\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"review-item\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"review-header\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"reviewer-info\",\n                children: [(_review$userId = review.userId) !== null && _review$userId !== void 0 && _review$userId.avatar ? /*#__PURE__*/_jsxDEV(\"img\", {\n                  src: review.userId.avatar,\n                  alt: (_review$userId2 = review.userId) === null || _review$userId2 === void 0 ? void 0 : _review$userId2.name,\n                  className: \"review-avatar\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 412,\n                  columnNumber: 45\n                }, this) : /*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"fa fa-user-circle\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 414,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: ((_review$userId3 = review.userId) === null || _review$userId3 === void 0 ? void 0 : _review$userId3.name) || \"Usuario\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 416,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 410,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"review-rating\",\n                children: renderStars(review.rating || 0)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 418,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 409,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"review-date\",\n              children: new Date(review.createdAt || review.date).toLocaleDateString(\"es-CR\")\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 420,\n              columnNumber: 33\n            }, this), review.comment && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"review-comment\",\n              children: review.comment\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 423,\n              columnNumber: 52\n            }, this)]\n          }, review._id || review.id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 408,\n            columnNumber: 29\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 406,\n        columnNumber: 21\n      }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"no-reviews\",\n        children: \"A\\xFAn no hay rese\\xF1as para este producto.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 428,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 403,\n      columnNumber: 13\n    }, this), sellerInfo && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"product-reviews-section\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"\\uD83C\\uDFEA Rese\\xF1as de la Tienda\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 435,\n        columnNumber: 21\n      }, this), storeReviews.length > 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"reviews-list\",\n        children: storeReviews.slice(0, 10).map(review => {\n          var _review$userId4, _review$userId5, _review$userId6;\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"review-item\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"review-header\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"reviewer-info\",\n                children: [(_review$userId4 = review.userId) !== null && _review$userId4 !== void 0 && _review$userId4.avatar ? /*#__PURE__*/_jsxDEV(\"img\", {\n                  src: review.userId.avatar,\n                  alt: (_review$userId5 = review.userId) === null || _review$userId5 === void 0 ? void 0 : _review$userId5.name,\n                  className: \"review-avatar\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 443,\n                  columnNumber: 49\n                }, this) : /*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"fa fa-user-circle\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 445,\n                  columnNumber: 49\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: ((_review$userId6 = review.userId) === null || _review$userId6 === void 0 ? void 0 : _review$userId6.name) || \"Usuario\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 447,\n                  columnNumber: 45\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 441,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"review-rating\",\n                children: renderStars(review.rating || 0)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 449,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 440,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"review-date\",\n              children: new Date(review.createdAt).toLocaleDateString(\"es-CR\")\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 451,\n              columnNumber: 37\n            }, this), review.comment && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"review-comment\",\n              children: review.comment\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 452,\n              columnNumber: 56\n            }, this)]\n          }, review._id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 439,\n            columnNumber: 33\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 437,\n        columnNumber: 25\n      }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"no-reviews\",\n        children: \"A\\xFAn no hay rese\\xF1as para esta tienda.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 457,\n        columnNumber: 25\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 434,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"navigation-actions\",\n      children: /*#__PURE__*/_jsxDEV(Link, {\n        to: \"/shop\",\n        className: \"btn-back\",\n        children: [/*#__PURE__*/_jsxDEV(\"i\", {\n          className: \"fa fa-arrow-left\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 465,\n          columnNumber: 21\n        }, this), \" Volver a la tienda\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 464,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 463,\n      columnNumber: 13\n    }, this), showReviewForm && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"modal-overlay\",\n      onClick: () => setShowReviewForm(false),\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"modal-content\",\n        onClick: e => e.stopPropagation(),\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"modal-header\",\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            children: \"Evaluar Producto\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 474,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setShowReviewForm(false),\n            className: \"modal-close\",\n            children: /*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"fa fa-times\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 476,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 475,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 473,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"modal-body\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"rating-section\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Calificaci\\xF3n del producto:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 481,\n              columnNumber: 33\n            }, this), renderStars(userRating, true, setUserRating)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 480,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"comment-section\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Comentario (opcional):\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 485,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n              value: reviewComment,\n              onChange: e => setReviewComment(e.target.value),\n              placeholder: \"Contanos tu experiencia\\u2026\",\n              rows: 4\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 486,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 484,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 479,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"modal-footer\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setShowReviewForm(false),\n            className: \"btn-cancel\",\n            children: \"Cancelar\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 495,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleSubmitReview,\n            className: \"btn-submit\",\n            disabled: userRating === 0,\n            children: \"Enviar Rese\\xF1a\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 498,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 494,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 472,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 471,\n      columnNumber: 17\n    }, this), showStoreReviewForm && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"modal-overlay\",\n      onClick: () => setShowStoreReviewForm(false),\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"modal-content\",\n        onClick: e => e.stopPropagation(),\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"modal-header\",\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            children: \"Evaluar Tienda\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 511,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setShowStoreReviewForm(false),\n            className: \"modal-close\",\n            children: /*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"fa fa-times\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 513,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 512,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 510,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"modal-body\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"rating-section\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Calificaci\\xF3n de la tienda:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 518,\n              columnNumber: 33\n            }, this), renderStars(storeUserRating, true, setStoreUserRating)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 517,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"comment-section\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Comentario (opcional):\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 522,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n              value: storeReviewComment,\n              onChange: e => setStoreReviewComment(e.target.value),\n              placeholder: \"\\xBFC\\xF3mo fue tu experiencia con la tienda?\",\n              rows: 4\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 523,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 521,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 516,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"modal-footer\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setShowStoreReviewForm(false),\n            className: \"btn-cancel\",\n            children: \"Cancelar\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 532,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleSubmitStoreReview,\n            className: \"btn-submit\",\n            disabled: storeUserRating === 0,\n            children: \"Enviar Rese\\xF1a\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 535,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 531,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 509,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 508,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 246,\n    columnNumber: 9\n  }, this);\n};\n_s(ProductPage, \"Fx8C67JM2xqNMprgjA9uNc3a508=\", false, function () {\n  return [useParams, useNavigate, useLocation, useAuth];\n});\n_c = ProductPage;\nexport default ProductPage;\nvar _c;\n$RefreshReg$(_c, \"ProductPage\");","map":{"version":3,"names":["React","useState","useEffect","useParams","Link","useNavigate","useLocation","useAuth","ShopAPI","ReviewsAPI","resolveImgUrl","noImage","CartAPI","jsxDEV","_jsxDEV","Fragment","_Fragment","fmtCRC","n","toLocaleString","catLabel","c","map","jewelery","art","ceramics","textiles","decoration","bags","wood","toUpperCase","slice","firstImg","p","arr","Array","isArray","images","candidate","find","Boolean","String","replace","isObjectId","s","test","ProductPage","_s","params","slugOrId","slug","id","navigate","routerLocation","user","token","authToken","localStorage","getItem","product","setProduct","sellerInfo","setSellerInfo","quantity","setQuantity","addedToCart","setAddedToCart","productReviews","setProductReviews","averageRating","setAverageRating","userRating","setUserRating","reviewComment","setReviewComment","showReviewForm","setShowReviewForm","storeReviews","setStoreReviews","storeAvg","setStoreAvg","storeUserRating","setStoreUserRating","storeReviewComment","setStoreReviewComment","showStoreReviewForm","setShowStoreReviewForm","renderStars","rating","interactive","onStarClick","className","children","star","Math","round","onClick","undefined","fileName","_jsxFileName","lineNumber","columnNumber","load","_resDetail$data","resDetail","get","detail","data","vendorId","_id","businessName","companyName","name","role","avatar","pid","_resReviews$data","resReviews","listProduct","page","limit","list","avg","reduce","acc","rv","length","mine","r","_r$userId","userId","comment","vid","_r2$data","r2","listStore","list2","avg2","a","b","mine2","_r$userId2","err","_err$response","console","error","response","message","imgSrc","useMemo","raw","image","img","thumbnail","normalized","resolved","handleAddToCart","ref","add","productId","productRef","setTimeout","e","_e$response","_e$response2","_e$response2$data","status","next","encodeURIComponent","pathname","search","alert","handleSubmitReview","userType","upsertProduct","_error$response","_error$response$data","handleSubmitStoreReview","upsertStore","_error$response2","_error$response2$data","mergedReviews","to","title","src","alt","loading","decoding","referrerPolicy","crossOrigin","onError","currentTarget","onerror","category","toFixed","price","description","max","disabled","stock","style","marginLeft","review","_review$userId","_review$userId2","_review$userId3","Date","createdAt","date","toLocaleDateString","_review$userId4","_review$userId5","_review$userId6","stopPropagation","value","onChange","target","placeholder","rows","_c","$RefreshReg$"],"sources":["C:/Users/adria/Desktop/artesjac-test2/artesjac-test2/src/pages/ProductPage.js"],"sourcesContent":["// src/pages/ProductPage.js\r\nimport React, { useState, useEffect } from \"react\";\r\nimport { useParams, Link, useNavigate, useLocation } from \"react-router-dom\";\r\nimport { useAuth } from \"../modules/auth/AuthContext\";\r\nimport { ShopAPI } from \"../api/shop.service\";\r\nimport { ReviewsAPI } from \"../api/reviews.service\";\r\nimport { resolveImgUrl } from \"../utils/resolveImgUrl\";\r\nimport noImage from \"../assets/images/noimage.png\";\r\nimport \"../styles/product.css\";\r\nimport { CartAPI } from \"../api/cart.service\";\r\n\r\n// Formateo de colones CR\r\nconst fmtCRC = (n) => (typeof n === \"number\" ? `₡${n.toLocaleString(\"es-CR\")}` : n);\r\n\r\n// Traducción simple de categorías (si en DB están en inglés)\r\nconst catLabel = (c) => {\r\n    const map = {\r\n        jewelery: \"Joyería\",\r\n        art: \"Pintura\",\r\n        ceramics: \"Cerámica\",\r\n        textiles: \"Textil\",\r\n        decoration: \"Decoración\",\r\n        bags: \"Bolsos\",\r\n        wood: \"Madera\",\r\n    };\r\n    return map[c] || (c ? c[0].toUpperCase() + c.slice(1) : \"General\");\r\n};\r\n\r\n// Saca la primera imagen válida del arreglo (se usa para carrito)\r\nconst firstImg = (p) => {\r\n    const arr = Array.isArray(p?.images) ? p.images : [];\r\n    const candidate = arr.find(Boolean);\r\n    return candidate ? String(candidate).replace(/\\\\/g, \"/\") : null;\r\n};\r\n\r\nconst isObjectId = (s) => /^[a-f\\d]{24}$/i.test(String(s || \"\"));\r\n\r\nexport const ProductPage = () => {\r\n    // Soporta ruta /p/:slug o /product/:id (cualquiera de los dos)\r\n    const params = useParams();\r\n    const slugOrId = params.slug || params.id;\r\n\r\n    const navigate = useNavigate();\r\n    const routerLocation = useLocation(); // ✅ usar routerLocation, no el global \"location\"\r\n    const { user, token } = useAuth() || {};\r\n    const authToken = token || localStorage.getItem(\"token\") || localStorage.getItem(\"authToken\");\r\n\r\n    const [product, setProduct] = useState(null);\r\n    const [sellerInfo, setSellerInfo] = useState(null);\r\n\r\n    const [quantity, setQuantity] = useState(1);\r\n    const [addedToCart, setAddedToCart] = useState(false);\r\n\r\n    // --- Reviews del PRODUCTO ---\r\n    const [productReviews, setProductReviews] = useState([]);\r\n    const [averageRating, setAverageRating] = useState(0);\r\n    const [userRating, setUserRating] = useState(0);\r\n    const [reviewComment, setReviewComment] = useState(\"\");\r\n    const [showReviewForm, setShowReviewForm] = useState(false);\r\n\r\n    // --- Reviews de la TIENDA ---\r\n    const [storeReviews, setStoreReviews] = useState([]);\r\n    const [storeAvg, setStoreAvg] = useState(0);\r\n    const [storeUserRating, setStoreUserRating] = useState(0);\r\n    const [storeReviewComment, setStoreReviewComment] = useState(\"\");\r\n    const [showStoreReviewForm, setShowStoreReviewForm] = useState(false);\r\n\r\n    const renderStars = (rating, interactive = false, onStarClick = null) => (\r\n        <div className={`stars ${interactive ? \"interactive\" : \"\"}`}>\r\n            {[1, 2, 3, 4, 5].map((star) => (\r\n                <i\r\n                    key={star}\r\n                    className={`fa fa-star ${star <= Math.round(rating) ? \"active\" : \"\"}`}\r\n                    onClick={interactive ? () => onStarClick(star) : undefined}\r\n                />\r\n            ))}\r\n        </div>\r\n    );\r\n\r\n    // Cargar detalle + reseñas desde DB\r\n    const load = async () => {\r\n        try {\r\n            // Detalle por slugOrId\r\n            const resDetail = await ShopAPI.get(slugOrId);\r\n            const detail = resDetail?.data?.data;\r\n            if (!detail) {\r\n                setProduct(null);\r\n                return;\r\n            }\r\n            setProduct(detail);\r\n\r\n            // Vendedor\r\n            if (detail.vendorId) {\r\n                const vendorId = detail.vendorId._id || detail.vendorId.id || detail.vendorId;\r\n                setSellerInfo({\r\n                    id: vendorId,\r\n                    businessName: detail.vendorId.companyName || detail.vendorId.name,\r\n                    name: detail.vendorId.name,\r\n                    role: detail.vendorId.role,\r\n                    avatar: detail.vendorId.avatar,\r\n                });\r\n            } else {\r\n                setSellerInfo(null);\r\n            }\r\n\r\n            // PRODUCT REVIEWS (DB)\r\n            const pid = detail._id || detail.id;\r\n            if (pid) {\r\n                const resReviews = await ReviewsAPI.listProduct(pid, { page: 1, limit: 50 });\r\n                const list = resReviews?.data?.data || [];\r\n                setProductReviews(list);\r\n\r\n                const avg = list.reduce((acc, rv) => acc + (rv.rating || 0), 0) / (list.length || 1);\r\n                setAverageRating(list.length ? avg : 0);\r\n\r\n                // Si el usuario ya reseñó este producto, precarga para editar\r\n                const mine = user && list.find((r) => String(r.userId?._id || r.userId) === String(user.id));\r\n                if (mine) {\r\n                    setUserRating(mine.rating);\r\n                    setReviewComment(mine.comment || \"\");\r\n                }\r\n            } else {\r\n                setProductReviews([]);\r\n                setAverageRating(0);\r\n            }\r\n\r\n            // STORE REVIEWS (DB)\r\n            const vid =\r\n                detail.vendorId && (detail.vendorId._id || detail.vendorId.id || detail.vendorId);\r\n            if (vid && isObjectId(vid)) {\r\n                const r2 = await ReviewsAPI.listStore(vid, { page: 1, limit: 50 });\r\n                const list2 = r2?.data?.data || [];\r\n                setStoreReviews(list2);\r\n                const avg2 = list2.reduce((a, b) => a + (b.rating || 0), 0) / (list2.length || 1);\r\n                setStoreAvg(list2.length ? avg2 : 0);\r\n\r\n                const mine2 =\r\n                    user && list2.find((r) => String(r.userId?._id || r.userId) === String(user.id));\r\n                if (mine2) {\r\n                    setStoreUserRating(mine2.rating);\r\n                    setStoreReviewComment(mine2.comment || \"\");\r\n                }\r\n            } else {\r\n                setStoreReviews([]);\r\n                setStoreAvg(0);\r\n            }\r\n        } catch (err) {\r\n            console.error(\"Product detail error:\", err?.response?.data || err.message);\r\n            setProduct(null);\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        load();\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [slugOrId]);\r\n\r\n    // ✅ URL de imagen robusta con fallbacks\r\n    const imgSrc = React.useMemo(() => {\r\n        if (!product) return noImage;\r\n        const raw =\r\n            Array.isArray(product?.images) && product.images.length\r\n                ? product.images.find(Boolean)\r\n                : product?.image || product?.img || product?.thumbnail || null;\r\n        if (!raw) return noImage;\r\n        const normalized = String(raw).replace(/\\\\/g, \"/\");\r\n        try {\r\n            const resolved = resolveImgUrl(normalized);\r\n            return resolved || normalized || noImage;\r\n        } catch {\r\n            return normalized || noImage;\r\n        }\r\n    }, [product]);\r\n\r\n    // === Agregar al carrito (server-first) ===\r\n   const handleAddToCart = async () => {\r\n  if (!product) return;\r\n\r\n  const id = product._id || product.id || null;\r\n  const ref = product.slug || product.id || id;\r\n\r\n  try {\r\n    await CartAPI.add({ productId: id, productRef: ref, quantity });\r\n    setAddedToCart(true);\r\n    setTimeout(() => setAddedToCart(false), 2000);\r\n  } catch (e) {\r\n    const status = e?.response?.status;\r\n    if (status === 401 || status === 403) {\r\n      const next = encodeURIComponent(`${routerLocation.pathname}${routerLocation.search || \"\"}`);\r\n      return navigate(`/login?next=${next}`);\r\n    }\r\n    alert(e?.response?.data?.error || \"No se pudo guardar en tu carrito\");\r\n  }\r\n};\r\n\r\n    // === Enviar/actualizar RESEÑA de PRODUCTO (1 por comprador) ===\r\n    const handleSubmitReview = async () => {\r\n        if (!user || user.userType !== \"buyer\" || !product || userRating === 0) return;\r\n        try {\r\n            const pid = product._id || product.id;\r\n            await ReviewsAPI.upsertProduct({ productId: pid, rating: userRating, comment: reviewComment }, authToken);\r\n            await load();\r\n            setShowReviewForm(false);\r\n            alert(\"¡Reseña del producto guardada!\");\r\n        } catch (error) {\r\n            console.error(\"Error al guardar reseña:\", error);\r\n            alert(error?.response?.data?.error || \"Error al enviar la reseña\");\r\n        }\r\n    };\r\n\r\n    // === Enviar/actualizar RESEÑA de TIENDA (1 por comprador) ===\r\n    const handleSubmitStoreReview = async () => {\r\n        if (!user || user.userType !== \"buyer\" || !sellerInfo || storeUserRating === 0) return;\r\n        try {\r\n            await ReviewsAPI.upsertStore(\r\n                { vendorId: sellerInfo.id, rating: storeUserRating, comment: storeReviewComment },\r\n                authToken\r\n            );\r\n            await load();\r\n            setShowStoreReviewForm(false);\r\n            alert(\"¡Reseña de la tienda guardada!\");\r\n        } catch (error) {\r\n            console.error(\"Error al guardar reseña tienda:\", error);\r\n            alert(error?.response?.data?.error || \"Error al enviar la reseña\");\r\n        }\r\n    };\r\n\r\n    // En esta versión ya NO se usa localStorage para reseñas\r\n    const mergedReviews = productReviews;\r\n\r\n    if (!product) {\r\n        return (\r\n            <main className=\"product-container\">\r\n                <div className=\"product-not-found\">\r\n                    <h2>Producto no encontrado</h2>\r\n                    <p>El producto que buscas no existe o ha sido removido.</p>\r\n                    <Link to=\"/shop\" className=\"btn-back-shop\">\r\n                        Volver a la tienda\r\n                    </Link>\r\n                </div>\r\n            </main>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <main className=\"product-container\">\r\n            {/* Breadcrumb */}\r\n            <nav className=\"breadcrumb\">\r\n                <Link to=\"/\">Inicio</Link>\r\n                <span>/</span>\r\n                <Link to=\"/shop\">Tienda</Link>\r\n                <span>/</span>\r\n                <span className=\"current\">{product.title}</span>\r\n            </nav>\r\n\r\n            <div className=\"product-detail\">\r\n                {/* Imagen del producto */}\r\n                <div className=\"product-image-section\">\r\n                    <div className=\"product-image-main\">\r\n                        <img\r\n                            className=\"product-image-sim large\"\r\n                            src={imgSrc}\r\n                            alt={product.title}\r\n                            loading=\"lazy\"\r\n                            decoding=\"async\"\r\n                            referrerPolicy=\"no-referrer\"\r\n                            crossOrigin=\"anonymous\"\r\n                            onError={(e) => {\r\n                                e.currentTarget.onerror = null;\r\n                                e.currentTarget.src = noImage;\r\n                            }}\r\n                        />\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Información del producto */}\r\n                <div className=\"product-info-section\">\r\n                    <div className=\"product-category\">{catLabel(product.category)}</div>\r\n\r\n                    <h1 className=\"product-title\">{product.title}</h1>\r\n\r\n                    {/* Rating del producto */}\r\n                    <div className=\"product-rating\">\r\n                        {renderStars(averageRating)}\r\n                        <span className=\"rating-text\">\r\n                            {averageRating > 0 ? averageRating.toFixed(1) : \"Sin calificar\"}\r\n                            {productReviews.length ? ` (${productReviews.length} reseñas)` : \"\"}\r\n                        </span>\r\n                    </div>\r\n\r\n                    <div className=\"product-price-main\">{fmtCRC(product.price)}</div>\r\n\r\n                    <div className=\"product-description\">\r\n                        <h3>Descripción</h3>\r\n                        <p>{product.description || \"Sin descripción\"}</p>\r\n                    </div>\r\n\r\n                    <div className=\"product-purchase\">\r\n                        <div className=\"quantity-section\">\r\n                            <label>Cantidad:</label>\r\n                            <div className=\"quantity-controls\">\r\n                                <button onClick={() => setQuantity(Math.max(1, quantity - 1))} className=\"quantity-btn\">\r\n                                    <i className=\"fa fa-minus\" />\r\n                                </button>\r\n                                <span className=\"quantity-display\">{quantity}</span>\r\n                                <button onClick={() => setQuantity(quantity + 1)} className=\"quantity-btn\">\r\n                                    <i className=\"fa fa-plus\" />\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div className=\"purchase-actions\">\r\n                            <button\r\n                                className={`btn-add-to-cart ${addedToCart ? \"added\" : \"\"}`}\r\n                                onClick={handleAddToCart}\r\n                                disabled={product.stock <= 0}\r\n                            >\r\n                                {addedToCart ? (\r\n                                    <>\r\n                                        <i className=\"fa fa-check\" /> ¡Agregado!\r\n                                    </>\r\n                                ) : (\r\n                                    <>\r\n                                        <i className=\"fa fa-shopping-cart\" /> Agregar al carrito\r\n                                    </>\r\n                                )}\r\n                            </button>\r\n\r\n                            <button\r\n                                className=\"btn-buy-now\"\r\n                                disabled={product.stock <= 0}\r\n                                onClick={() => {\r\n                                    handleAddToCart();\r\n                                    setTimeout(() => navigate(\"/cart\"), 400);\r\n                                }}\r\n                            >\r\n                                <i className=\"fa fa-bolt\" /> Comprar ahora\r\n                            </button>\r\n                        </div>\r\n\r\n                        {/* Botón para evaluar producto */}\r\n                        {user && user.userType === \"buyer\" && (\r\n                            <button className=\"btn-review-product\" onClick={() => setShowReviewForm(true)}>\r\n                                <i className=\"fa fa-star\" /> Evaluar Producto\r\n                            </button>\r\n                        )}\r\n                    </div>\r\n\r\n                    <div className=\"product-features\">\r\n                        <div className=\"feature\">\r\n                            <i className=\"fa fa-truck\" />\r\n                            <span>Envío a todo Costa Rica</span>\r\n                        </div>\r\n                        <div className=\"feature\">\r\n                            <i className=\"fa fa-shield-alt\" />\r\n                            <span>Garantía de calidad artesanal</span>\r\n                        </div>\r\n                        <div className=\"feature\">\r\n                            <i className=\"fa fa-heart\" />\r\n                            <span>Hecho con amor por artesanos locales</span>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Información del Vendedor */}\r\n            {sellerInfo && (\r\n                <div className=\"seller-info-section\">\r\n                    <h2>🏪 Información del Vendedor</h2>\r\n                    <div className=\"seller-card\">\r\n                        <div className=\"seller-header\">\r\n                            <div className=\"seller-avatar\">\r\n                                {sellerInfo.avatar ? (\r\n                                    <img src={sellerInfo.avatar} alt={sellerInfo.businessName || sellerInfo.name} />\r\n                                ) : (\r\n                                    <i className=\"fa fa-store\" />\r\n                                )}\r\n                            </div>\r\n                            <div className=\"seller-details\">\r\n                                <h3>{sellerInfo.businessName || sellerInfo.name}</h3>\r\n                                {sellerInfo.role && <p className=\"seller-category\">{String(sellerInfo.role).toUpperCase()}</p>}\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div className=\"seller-actions\">\r\n                            {/* Mantengo tu botón original */}\r\n                            <Link to={`/seller-profile/${sellerInfo.id || product.vendorId}`} className=\"btn-view-store\">\r\n                                <i className=\"fa fa-eye\" /> Ver Tienda Completa\r\n                            </Link>\r\n\r\n                            {/* Botón para evaluar TIENDA */}\r\n                            {user && user.userType === \"buyer\" && isObjectId(sellerInfo.id) && (\r\n                                <button onClick={() => setShowStoreReviewForm(true)} className=\"btn-review-product\" style={{ marginLeft: 8 }}>\r\n                                    <i className=\"fa fa-star\" /> Evaluar Tienda\r\n                                </button>\r\n                            )}\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {/* Reseñas del Producto */}\r\n            <div className=\"product-reviews-section\">\r\n                <h2>⭐ Reseñas del Producto</h2>\r\n                {mergedReviews.length > 0 ? (\r\n                    <div className=\"reviews-list\">\r\n                        {mergedReviews.slice(0, 10).map((review) => (\r\n                            <div key={review._id || review.id} className=\"review-item\">\r\n                                <div className=\"review-header\">\r\n                                    <div className=\"reviewer-info\">\r\n                                        {review.userId?.avatar ? (\r\n                                            <img src={review.userId.avatar} alt={review.userId?.name} className=\"review-avatar\" />\r\n                                        ) : (\r\n                                            <i className=\"fa fa-user-circle\" />\r\n                                        )}\r\n                                        <span>{review.userId?.name || \"Usuario\"}</span>\r\n                                    </div>\r\n                                    <div className=\"review-rating\">{renderStars(review.rating || 0)}</div>\r\n                                </div>\r\n                                <div className=\"review-date\">\r\n                                    {new Date(review.createdAt || review.date).toLocaleDateString(\"es-CR\")}\r\n                                </div>\r\n                                {review.comment && <div className=\"review-comment\">{review.comment}</div>}\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                ) : (\r\n                    <p className=\"no-reviews\">Aún no hay reseñas para este producto.</p>\r\n                )}\r\n            </div>\r\n\r\n            {/* Reseñas de la Tienda */}\r\n            {sellerInfo && (\r\n                <div className=\"product-reviews-section\">\r\n                    <h2>🏪 Reseñas de la Tienda</h2>\r\n                    {storeReviews.length > 0 ? (\r\n                        <div className=\"reviews-list\">\r\n                            {storeReviews.slice(0, 10).map((review) => (\r\n                                <div key={review._id} className=\"review-item\">\r\n                                    <div className=\"review-header\">\r\n                                        <div className=\"reviewer-info\">\r\n                                            {review.userId?.avatar ? (\r\n                                                <img src={review.userId.avatar} alt={review.userId?.name} className=\"review-avatar\" />\r\n                                            ) : (\r\n                                                <i className=\"fa fa-user-circle\" />\r\n                                            )}\r\n                                            <span>{review.userId?.name || \"Usuario\"}</span>\r\n                                        </div>\r\n                                        <div className=\"review-rating\">{renderStars(review.rating || 0)}</div>\r\n                                    </div>\r\n                                    <div className=\"review-date\">{new Date(review.createdAt).toLocaleDateString(\"es-CR\")}</div>\r\n                                    {review.comment && <div className=\"review-comment\">{review.comment}</div>}\r\n                                </div>\r\n                            ))}\r\n                        </div>\r\n                    ) : (\r\n                        <p className=\"no-reviews\">Aún no hay reseñas para esta tienda.</p>\r\n                    )}\r\n                </div>\r\n            )}\r\n\r\n            {/* Botón de regreso */}\r\n            <div className=\"navigation-actions\">\r\n                <Link to=\"/shop\" className=\"btn-back\">\r\n                    <i className=\"fa fa-arrow-left\" /> Volver a la tienda\r\n                </Link>\r\n            </div>\r\n\r\n            {/* Modal para evaluar producto */}\r\n            {showReviewForm && (\r\n                <div className=\"modal-overlay\" onClick={() => setShowReviewForm(false)}>\r\n                    <div className=\"modal-content\" onClick={(e) => e.stopPropagation()}>\r\n                        <div className=\"modal-header\">\r\n                            <h2>Evaluar Producto</h2>\r\n                            <button onClick={() => setShowReviewForm(false)} className=\"modal-close\">\r\n                                <i className=\"fa fa-times\" />\r\n                            </button>\r\n                        </div>\r\n                        <div className=\"modal-body\">\r\n                            <div className=\"rating-section\">\r\n                                <label>Calificación del producto:</label>\r\n                                {renderStars(userRating, true, setUserRating)}\r\n                            </div>\r\n                            <div className=\"comment-section\">\r\n                                <label>Comentario (opcional):</label>\r\n                                <textarea\r\n                                    value={reviewComment}\r\n                                    onChange={(e) => setReviewComment(e.target.value)}\r\n                                    placeholder=\"Contanos tu experiencia…\"\r\n                                    rows={4}\r\n                                />\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"modal-footer\">\r\n                            <button onClick={() => setShowReviewForm(false)} className=\"btn-cancel\">\r\n                                Cancelar\r\n                            </button>\r\n                            <button onClick={handleSubmitReview} className=\"btn-submit\" disabled={userRating === 0}>\r\n                                Enviar Reseña\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {/* Modal para evaluar TIENDA */}\r\n            {showStoreReviewForm && (\r\n                <div className=\"modal-overlay\" onClick={() => setShowStoreReviewForm(false)}>\r\n                    <div className=\"modal-content\" onClick={(e) => e.stopPropagation()}>\r\n                        <div className=\"modal-header\">\r\n                            <h2>Evaluar Tienda</h2>\r\n                            <button onClick={() => setShowStoreReviewForm(false)} className=\"modal-close\">\r\n                                <i className=\"fa fa-times\" />\r\n                            </button>\r\n                        </div>\r\n                        <div className=\"modal-body\">\r\n                            <div className=\"rating-section\">\r\n                                <label>Calificación de la tienda:</label>\r\n                                {renderStars(storeUserRating, true, setStoreUserRating)}\r\n                            </div>\r\n                            <div className=\"comment-section\">\r\n                                <label>Comentario (opcional):</label>\r\n                                <textarea\r\n                                    value={storeReviewComment}\r\n                                    onChange={(e) => setStoreReviewComment(e.target.value)}\r\n                                    placeholder=\"¿Cómo fue tu experiencia con la tienda?\"\r\n                                    rows={4}\r\n                                />\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"modal-footer\">\r\n                            <button onClick={() => setShowStoreReviewForm(false)} className=\"btn-cancel\">\r\n                                Cancelar\r\n                            </button>\r\n                            <button onClick={handleSubmitStoreReview} className=\"btn-submit\" disabled={storeUserRating === 0}>\r\n                                Enviar Reseña\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </main>\r\n    );\r\n};\r\n\r\nexport default ProductPage;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}