{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\jospa\\\\OneDrive\\\\Desktop\\\\artesjac-test2\\\\artesjac-test2\\\\src\\\\pages\\\\ProductPage.js\",\n  _s = $RefreshSig$();\n// src/pages/ProductPage.js\nimport React, { useState, useEffect } from \"react\";\nimport { useParams, Link, useNavigate, useSearchParams } from \"react-router-dom\";\nimport { useAuth } from \"../modules/auth/AuthContext\";\nimport { ShopAPI } from \"../api/shop.service\";\nimport { resolveImgUrl } from \"../utils/resolveImgUrl\";\nimport noImage from \"../assets/images/noimage.png\";\nimport \"../styles/product.css\";\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst fmtCRC = n => typeof n === \"number\" ? `‚Ç°${n.toLocaleString(\"es-CR\")}` : n;\nconst catLabel = c => {\n  const map = {\n    jewelery: \"Joyer√≠a\",\n    art: \"Pintura\",\n    ceramics: \"Cer√°mica\",\n    textiles: \"Textil\",\n    decoration: \"Decoraci√≥n\",\n    bags: \"Bolsos\",\n    wood: \"Madera\"\n  };\n  return map[c] || (c ? c[0].toUpperCase() + c.slice(1) : \"General\");\n};\nconst firstImg = p => {\n  const arr = Array.isArray(p === null || p === void 0 ? void 0 : p.images) ? p.images : [];\n  const candidate = arr.find(Boolean);\n  return candidate ? String(candidate).replace(/\\\\/g, \"/\") : null;\n};\nexport const ProductPage = () => {\n  _s();\n  const params = useParams();\n  const slugOrId = params.slug || params.id;\n  const navigate = useNavigate();\n  const {\n    user,\n    token\n  } = useAuth() || {};\n  const authToken = token || localStorage.getItem(\"token\") || localStorage.getItem(\"authToken\");\n  const [product, setProduct] = useState(null);\n  const [seller, setSeller] = useState(null);\n  const [quantity, setQuantity] = useState(1);\n  const [addedToCart, setAddedToCart] = useState(false);\n  const [reviews, setReviews] = useState([]);\n  const [averageRating, setAverageRating] = useState(0);\n  const [userRating, setUserRating] = useState(0);\n  const [reviewComment, setReviewComment] = useState(\"\");\n  const [showReviewForm, setShowReviewForm] = useState(false);\n  const load = async () => {\n    try {\n      var _resDetail$data, _resReviews$data;\n      const resDetail = await ShopAPI.get(slugOrId);\n      const detail = resDetail === null || resDetail === void 0 ? void 0 : (_resDetail$data = resDetail.data) === null || _resDetail$data === void 0 ? void 0 : _resDetail$data.data;\n      if (!detail) {\n        setProduct(null);\n        return;\n      }\n      setProduct(detail);\n      if (detail.vendorId) {\n        setSeller({\n          id: detail.vendorId._id || detail.vendorId.id,\n          businessName: detail.vendorId.companyName || detail.vendorId.name,\n          name: detail.vendorId.name,\n          role: detail.vendorId.role,\n          avatar: detail.vendorId.avatar\n        });\n      } else setSeller(null);\n      setAverageRating(typeof detail.averageRating === \"number\" ? detail.averageRating : 0);\n      const pid = detail._id || detail.id;\n      const resReviews = await ShopAPI.reviews(pid, {\n        page: 1,\n        limit: 20\n      });\n      const list = (resReviews === null || resReviews === void 0 ? void 0 : (_resReviews$data = resReviews.data) === null || _resReviews$data === void 0 ? void 0 : _resReviews$data.data) || [];\n      setReviews(list);\n      if (typeof detail.averageRating !== \"number\") {\n        const sum = list.reduce((acc, rv) => acc + (rv.rating || 0), 0);\n        setAverageRating(list.length ? sum / list.length : 0);\n      }\n    } catch (e) {\n      var _e$response;\n      console.error(\"Product detail error:\", (e === null || e === void 0 ? void 0 : (_e$response = e.response) === null || _e$response === void 0 ? void 0 : _e$response.data) || e.message);\n      setProduct(null);\n    }\n  };\n  useEffect(() => {\n    load(); /* eslint-disable-next-line */\n  }, [slugOrId]);\n  const handleAddToCart = () => {\n    if (!product) return;\n    try {\n      const savedCart = localStorage.getItem(\"artesjac-cart\");\n      let cart = savedCart ? JSON.parse(savedCart) : [];\n      const cartId = product._id || product.id || product.slug;\n      const existing = cart.find(it => it.id === cartId);\n      const img = firstImg(product);\n      if (existing) {\n        cart = cart.map(it => it.id === cartId ? {\n          ...it,\n          quantity: (it.quantity || 1) + quantity\n        } : it);\n      } else {\n        cart.push({\n          id: cartId,\n          productId: cartId,\n          slug: product.slug,\n          name: product.title,\n          title: product.title,\n          price: product.price,\n          quantity,\n          image: img,\n          category: product.category,\n          stock: product.stock\n        });\n      }\n      localStorage.setItem(\"artesjac-cart\", JSON.stringify(cart));\n      setAddedToCart(true);\n      setTimeout(() => setAddedToCart(false), 2000);\n    } catch (e) {\n      console.error(\"Add to cart error:\", e);\n    }\n  };\n\n  // ‚≠ê Crear/actualizar rese√±a REAL (servidor). 1 por comprador.\n  const handleSubmitReview = async () => {\n    if (!user || user.userType !== \"buyer\" || userRating === 0 || !product) return;\n    try {\n      var _res$data, _r$data;\n      const pid = product._id || product.id;\n      const res = await ShopAPI.createReview({\n        productId: pid,\n        rating: userRating,\n        comment: reviewComment\n      }, authToken);\n      if (!(res !== null && res !== void 0 && (_res$data = res.data) !== null && _res$data !== void 0 && _res$data.ok)) throw new Error(\"No se guard√≥ la rese√±a\");\n      // Recargar rese√±as y promedio desde el backend\n      const r = await ShopAPI.reviews(pid, {\n        page: 1,\n        limit: 20\n      });\n      const list = (r === null || r === void 0 ? void 0 : (_r$data = r.data) === null || _r$data === void 0 ? void 0 : _r$data.data) || [];\n      setReviews(list);\n      const sum = list.reduce((acc, rv) => acc + (rv.rating || 0), 0);\n      setAverageRating(list.length ? sum / list.length : 0);\n      // Reset\n      setUserRating(0);\n      setReviewComment(\"\");\n      setShowReviewForm(false);\n      alert(\"¬°Rese√±a guardada!\");\n    } catch (e) {\n      var _e$response2, _e$response3, _e$response3$data;\n      console.error(\"Review error:\", (e === null || e === void 0 ? void 0 : (_e$response2 = e.response) === null || _e$response2 === void 0 ? void 0 : _e$response2.data) || e.message);\n      alert((e === null || e === void 0 ? void 0 : (_e$response3 = e.response) === null || _e$response3 === void 0 ? void 0 : (_e$response3$data = _e$response3.data) === null || _e$response3$data === void 0 ? void 0 : _e$response3$data.error) || \"No se pudo guardar la rese√±a\");\n    }\n  };\n  const renderStars = (rating, interactive = false, onStarClick = null) => /*#__PURE__*/_jsxDEV(\"div\", {\n    className: `stars ${interactive ? \"interactive\" : \"\"}`,\n    children: [1, 2, 3, 4, 5].map(star => /*#__PURE__*/_jsxDEV(\"i\", {\n      className: `fa fa-star ${star <= Math.round(rating) ? \"active\" : \"\"}`,\n      onClick: interactive ? () => onStarClick(star) : undefined\n    }, star, false, {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 17\n    }, this))\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 126,\n    columnNumber: 9\n  }, this);\n  if (!product) {\n    return /*#__PURE__*/_jsxDEV(\"main\", {\n      className: \"product-container\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"product-not-found\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \"Producto no encontrado\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 141,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"El producto que buscas no existe o ha sido removido.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 142,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Link, {\n          to: \"/shop\",\n          className: \"btn-back-shop\",\n          children: \"Volver a la tienda\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 143,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 13\n    }, this);\n  }\n  const img = firstImg(product);\n  return /*#__PURE__*/_jsxDEV(\"main\", {\n    className: \"product-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"nav\", {\n      className: \"breadcrumb\",\n      children: [/*#__PURE__*/_jsxDEV(Link, {\n        to: \"/\",\n        children: \"Inicio\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 155,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        children: \"/\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 155,\n        columnNumber: 43\n      }, this), /*#__PURE__*/_jsxDEV(Link, {\n        to: \"/shop\",\n        children: \"Tienda\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        children: \"/\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 47\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"current\",\n        children: product.title\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 157,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"product-detail\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"product-image-section\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"product-image-main\",\n          children: /*#__PURE__*/_jsxDEV(\"img\", {\n            className: \"product-image-sim large\",\n            src: img ? resolveImgUrl(img) : noImage,\n            alt: product.title,\n            onError: e => {\n              e.currentTarget.src = noImage;\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 164,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 163,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 162,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"product-info-section\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"product-category\",\n          children: catLabel(product.category)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 175,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n          className: \"product-title\",\n          children: product.title\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 176,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"product-rating\",\n          children: [renderStars(averageRating), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"rating-text\",\n            children: [averageRating > 0 ? averageRating.toFixed(1) : \"Sin calificar\", typeof product.reviewsCount === \"number\" ? ` (${product.reviewsCount} rese√±as)` : \"\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 180,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 178,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"product-price-main\",\n          children: fmtCRC(product.price)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 186,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"product-description\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"Descripci\\xF3n\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 189,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: product.description || \"Sin descripci√≥n\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 190,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 188,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"product-purchase\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"quantity-section\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Cantidad:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 195,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"quantity-controls\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => setQuantity(Math.max(1, quantity - 1)),\n                className: \"quantity-btn\",\n                children: /*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"fa fa-minus\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 197,\n                  columnNumber: 121\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 197,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"quantity-display\",\n                children: quantity\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 198,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => setQuantity(quantity + 1),\n                className: \"quantity-btn\",\n                children: /*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"fa fa-plus\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 199,\n                  columnNumber: 108\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 199,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 196,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 194,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"purchase-actions\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              className: `btn-add-to-cart ${addedToCart ? \"added\" : \"\"}`,\n              onClick: handleAddToCart,\n              disabled: product.stock <= 0,\n              children: addedToCart ? /*#__PURE__*/_jsxDEV(_Fragment, {\n                children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"fa fa-check\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 205,\n                  columnNumber: 51\n                }, this), \" \\xA1Agregado!\"]\n              }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n                children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"fa fa-shopping-cart\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 205,\n                  columnNumber: 101\n                }, this), \" Agregar al carrito\"]\n              }, void 0, true)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 204,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"btn-buy-now\",\n              disabled: product.stock <= 0,\n              onClick: () => {\n                handleAddToCart();\n                setTimeout(() => navigate(\"/cart\"), 400);\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                className: \"fa fa-bolt\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 208,\n                columnNumber: 33\n              }, this), \" Comprar ahora\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 207,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 203,\n            columnNumber: 25\n          }, this), user && user.userType === \"buyer\" && /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn-review-product\",\n            onClick: () => setShowReviewForm(true),\n            children: [/*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"fa fa-star\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 215,\n              columnNumber: 33\n            }, this), \" Evaluar Producto\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 214,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 193,\n          columnNumber: 21\n        }, this), seller && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"seller-info-cta\",\n          style: {\n            marginTop: 16\n          },\n          children: /*#__PURE__*/_jsxDEV(Link, {\n            to: `/shop?vendor=${seller.id}`,\n            className: \"btn-view-store\",\n            children: [/*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"fa fa-eye\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 224,\n              columnNumber: 33\n            }, this), \" Ver tienda de \", seller.businessName || seller.name]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 223,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 222,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"product-features\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"feature\",\n            children: [/*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"fa fa-truck\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 230,\n              columnNumber: 50\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Env\\xEDo a todo Costa Rica\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 230,\n              columnNumber: 79\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 230,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"feature\",\n            children: [/*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"fa fa-shield-alt\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 231,\n              columnNumber: 50\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Garant\\xEDa de calidad artesanal\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 231,\n              columnNumber: 84\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 231,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"feature\",\n            children: [/*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"fa fa-heart\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 232,\n              columnNumber: 50\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Hecho con amor por artesanos locales\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 232,\n              columnNumber: 79\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 232,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 229,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 174,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"product-reviews-section\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"\\u2B50 Rese\\xF1as del Producto\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 239,\n        columnNumber: 17\n      }, this), reviews.length > 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"reviews-list\",\n        children: reviews.slice(0, 20).map(rv => {\n          var _rv$userId, _rv$userId2, _rv$userId3;\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"review-item\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"review-header\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"reviewer-info\",\n                children: [(_rv$userId = rv.userId) !== null && _rv$userId !== void 0 && _rv$userId.avatar ? /*#__PURE__*/_jsxDEV(\"img\", {\n                  src: rv.userId.avatar,\n                  alt: (_rv$userId2 = rv.userId) === null || _rv$userId2 === void 0 ? void 0 : _rv$userId2.name,\n                  className: \"review-avatar\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 247,\n                  columnNumber: 45\n                }, this) : /*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"fa fa-user-circle\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 249,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: ((_rv$userId3 = rv.userId) === null || _rv$userId3 === void 0 ? void 0 : _rv$userId3.name) || \"Usuario\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 251,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 245,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"review-rating\",\n                children: renderStars(rv.rating || 0)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 253,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 244,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"review-date\",\n              children: new Date(rv.createdAt).toLocaleDateString(\"es-CR\")\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 255,\n              columnNumber: 33\n            }, this), rv.comment && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"review-comment\",\n              children: rv.comment\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 256,\n              columnNumber: 48\n            }, this)]\n          }, rv._id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 243,\n            columnNumber: 29\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 241,\n        columnNumber: 21\n      }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"no-reviews\",\n        children: \"A\\xFAn no hay rese\\xF1as para este producto.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 261,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 238,\n      columnNumber: 13\n    }, this), showReviewForm && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"modal-overlay\",\n      onClick: () => setShowReviewForm(false),\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"modal-content\",\n        onClick: e => e.stopPropagation(),\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"modal-header\",\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            children: \"Evaluar Producto\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 270,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setShowReviewForm(false),\n            className: \"modal-close\",\n            children: /*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"fa fa-times\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 271,\n              columnNumber: 102\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 271,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 269,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"modal-body\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"rating-section\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Calificaci\\xF3n:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 275,\n              columnNumber: 33\n            }, this), renderStars(userRating, true, setUserRating)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 274,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"comment-section\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Comentario (opcional):\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 279,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n              value: reviewComment,\n              onChange: e => setReviewComment(e.target.value),\n              placeholder: \"Contanos tu experiencia\\u2026\",\n              rows: 4\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 280,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 278,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 273,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"modal-footer\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setShowReviewForm(false),\n            className: \"btn-cancel\",\n            children: \"Cancelar\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 284,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleSubmitReview,\n            className: \"btn-submit\",\n            disabled: userRating === 0,\n            children: \"Enviar Rese\\xF1a\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 285,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 283,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 268,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 267,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 152,\n    columnNumber: 9\n  }, this);\n};\n_s(ProductPage, \"ZqN+nCSRurzTGvkT2BAFwLIwpUw=\", false, function () {\n  return [useParams, useNavigate, useAuth];\n});\n_c = ProductPage;\nexport default ProductPage;\nvar _c;\n$RefreshReg$(_c, \"ProductPage\");","map":{"version":3,"names":["React","useState","useEffect","useParams","Link","useNavigate","useSearchParams","useAuth","ShopAPI","resolveImgUrl","noImage","jsxDEV","_jsxDEV","Fragment","_Fragment","fmtCRC","n","toLocaleString","catLabel","c","map","jewelery","art","ceramics","textiles","decoration","bags","wood","toUpperCase","slice","firstImg","p","arr","Array","isArray","images","candidate","find","Boolean","String","replace","ProductPage","_s","params","slugOrId","slug","id","navigate","user","token","authToken","localStorage","getItem","product","setProduct","seller","setSeller","quantity","setQuantity","addedToCart","setAddedToCart","reviews","setReviews","averageRating","setAverageRating","userRating","setUserRating","reviewComment","setReviewComment","showReviewForm","setShowReviewForm","load","_resDetail$data","_resReviews$data","resDetail","get","detail","data","vendorId","_id","businessName","companyName","name","role","avatar","pid","resReviews","page","limit","list","sum","reduce","acc","rv","rating","length","e","_e$response","console","error","response","message","handleAddToCart","savedCart","cart","JSON","parse","cartId","existing","it","img","push","productId","title","price","image","category","stock","setItem","stringify","setTimeout","handleSubmitReview","userType","_res$data","_r$data","res","createReview","comment","ok","Error","r","alert","_e$response2","_e$response3","_e$response3$data","renderStars","interactive","onStarClick","className","children","star","Math","round","onClick","undefined","fileName","_jsxFileName","lineNumber","columnNumber","to","src","alt","onError","currentTarget","toFixed","reviewsCount","description","max","disabled","style","marginTop","_rv$userId","_rv$userId2","_rv$userId3","userId","Date","createdAt","toLocaleDateString","stopPropagation","value","onChange","target","placeholder","rows","_c","$RefreshReg$"],"sources":["C:/Users/jospa/OneDrive/Desktop/artesjac-test2/artesjac-test2/src/pages/ProductPage.js"],"sourcesContent":["// src/pages/ProductPage.js\r\nimport React, { useState, useEffect } from \"react\";\r\nimport { useParams, Link, useNavigate, useSearchParams } from \"react-router-dom\";\r\nimport { useAuth } from \"../modules/auth/AuthContext\";\r\nimport { ShopAPI } from \"../api/shop.service\";\r\nimport { resolveImgUrl } from \"../utils/resolveImgUrl\";\r\nimport noImage from \"../assets/images/noimage.png\";\r\nimport \"../styles/product.css\";\r\n\r\nconst fmtCRC = (n) => (typeof n === \"number\" ? `‚Ç°${n.toLocaleString(\"es-CR\")}` : n);\r\nconst catLabel = (c) => {\r\n    const map = { jewelery: \"Joyer√≠a\", art: \"Pintura\", ceramics: \"Cer√°mica\", textiles: \"Textil\", decoration: \"Decoraci√≥n\", bags: \"Bolsos\", wood: \"Madera\" };\r\n    return map[c] || (c ? c[0].toUpperCase() + c.slice(1) : \"General\");\r\n};\r\nconst firstImg = (p) => {\r\n    const arr = Array.isArray(p?.images) ? p.images : [];\r\n    const candidate = arr.find(Boolean);\r\n    return candidate ? String(candidate).replace(/\\\\/g, \"/\") : null;\r\n};\r\n\r\nexport const ProductPage = () => {\r\n    const params = useParams();\r\n    const slugOrId = params.slug || params.id;\r\n    const navigate = useNavigate();\r\n    const { user, token } = useAuth() || {};\r\n    const authToken = token || localStorage.getItem(\"token\") || localStorage.getItem(\"authToken\");\r\n\r\n    const [product, setProduct] = useState(null);\r\n    const [seller, setSeller] = useState(null);\r\n    const [quantity, setQuantity] = useState(1);\r\n    const [addedToCart, setAddedToCart] = useState(false);\r\n    const [reviews, setReviews] = useState([]);\r\n    const [averageRating, setAverageRating] = useState(0);\r\n    const [userRating, setUserRating] = useState(0);\r\n    const [reviewComment, setReviewComment] = useState(\"\");\r\n    const [showReviewForm, setShowReviewForm] = useState(false);\r\n\r\n    const load = async () => {\r\n        try {\r\n            const resDetail = await ShopAPI.get(slugOrId);\r\n            const detail = resDetail?.data?.data;\r\n            if (!detail) { setProduct(null); return; }\r\n            setProduct(detail);\r\n\r\n            if (detail.vendorId) {\r\n                setSeller({\r\n                    id: detail.vendorId._id || detail.vendorId.id,\r\n                    businessName: detail.vendorId.companyName || detail.vendorId.name,\r\n                    name: detail.vendorId.name,\r\n                    role: detail.vendorId.role,\r\n                    avatar: detail.vendorId.avatar,\r\n                });\r\n            } else setSeller(null);\r\n\r\n            setAverageRating(typeof detail.averageRating === \"number\" ? detail.averageRating : 0);\r\n\r\n            const pid = detail._id || detail.id;\r\n            const resReviews = await ShopAPI.reviews(pid, { page: 1, limit: 20 });\r\n            const list = resReviews?.data?.data || [];\r\n            setReviews(list);\r\n\r\n            if (typeof detail.averageRating !== \"number\") {\r\n                const sum = list.reduce((acc, rv) => acc + (rv.rating || 0), 0);\r\n                setAverageRating(list.length ? sum / list.length : 0);\r\n            }\r\n        } catch (e) {\r\n            console.error(\"Product detail error:\", e?.response?.data || e.message);\r\n            setProduct(null);\r\n        }\r\n    };\r\n\r\n    useEffect(() => { load(); /* eslint-disable-next-line */ }, [slugOrId]);\r\n\r\n    const handleAddToCart = () => {\r\n        if (!product) return;\r\n        try {\r\n            const savedCart = localStorage.getItem(\"artesjac-cart\");\r\n            let cart = savedCart ? JSON.parse(savedCart) : [];\r\n            const cartId = product._id || product.id || product.slug;\r\n            const existing = cart.find((it) => it.id === cartId);\r\n            const img = firstImg(product);\r\n\r\n            if (existing) {\r\n                cart = cart.map((it) => (it.id === cartId ? { ...it, quantity: (it.quantity || 1) + quantity } : it));\r\n            } else {\r\n                cart.push({\r\n                    id: cartId, productId: cartId, slug: product.slug,\r\n                    name: product.title, title: product.title, price: product.price,\r\n                    quantity, image: img, category: product.category, stock: product.stock,\r\n                });\r\n            }\r\n            localStorage.setItem(\"artesjac-cart\", JSON.stringify(cart));\r\n            setAddedToCart(true);\r\n            setTimeout(() => setAddedToCart(false), 2000);\r\n        } catch (e) { console.error(\"Add to cart error:\", e); }\r\n    };\r\n\r\n    // ‚≠ê Crear/actualizar rese√±a REAL (servidor). 1 por comprador.\r\n    const handleSubmitReview = async () => {\r\n        if (!user || user.userType !== \"buyer\" || userRating === 0 || !product) return;\r\n        try {\r\n            const pid = product._id || product.id;\r\n            const res = await ShopAPI.createReview(\r\n                { productId: pid, rating: userRating, comment: reviewComment },\r\n                authToken\r\n            );\r\n            if (!res?.data?.ok) throw new Error(\"No se guard√≥ la rese√±a\");\r\n            // Recargar rese√±as y promedio desde el backend\r\n            const r = await ShopAPI.reviews(pid, { page: 1, limit: 20 });\r\n            const list = r?.data?.data || [];\r\n            setReviews(list);\r\n            const sum = list.reduce((acc, rv) => acc + (rv.rating || 0), 0);\r\n            setAverageRating(list.length ? sum / list.length : 0);\r\n            // Reset\r\n            setUserRating(0);\r\n            setReviewComment(\"\");\r\n            setShowReviewForm(false);\r\n            alert(\"¬°Rese√±a guardada!\");\r\n        } catch (e) {\r\n            console.error(\"Review error:\", e?.response?.data || e.message);\r\n            alert(e?.response?.data?.error || \"No se pudo guardar la rese√±a\");\r\n        }\r\n    };\r\n\r\n    const renderStars = (rating, interactive = false, onStarClick = null) => (\r\n        <div className={`stars ${interactive ? \"interactive\" : \"\"}`}>\r\n            {[1, 2, 3, 4, 5].map((star) => (\r\n                <i\r\n                    key={star}\r\n                    className={`fa fa-star ${star <= Math.round(rating) ? \"active\" : \"\"}`}\r\n                    onClick={interactive ? () => onStarClick(star) : undefined}\r\n                />\r\n            ))}\r\n        </div>\r\n    );\r\n\r\n    if (!product) {\r\n        return (\r\n            <main className=\"product-container\">\r\n                <div className=\"product-not-found\">\r\n                    <h2>Producto no encontrado</h2>\r\n                    <p>El producto que buscas no existe o ha sido removido.</p>\r\n                    <Link to=\"/shop\" className=\"btn-back-shop\">Volver a la tienda</Link>\r\n                </div>\r\n            </main>\r\n        );\r\n    }\r\n\r\n    const img = firstImg(product);\r\n\r\n    return (\r\n        <main className=\"product-container\">\r\n            {/* Breadcrumb */}\r\n            <nav className=\"breadcrumb\">\r\n                <Link to=\"/\">Inicio</Link><span>/</span>\r\n                <Link to=\"/shop\">Tienda</Link><span>/</span>\r\n                <span className=\"current\">{product.title}</span>\r\n            </nav>\r\n\r\n            <div className=\"product-detail\">\r\n                {/* Imagen */}\r\n                <div className=\"product-image-section\">\r\n                    <div className=\"product-image-main\">\r\n                        <img\r\n                            className=\"product-image-sim large\"\r\n                            src={img ? resolveImgUrl(img) : noImage}\r\n                            alt={product.title}\r\n                            onError={(e) => { e.currentTarget.src = noImage; }}\r\n                        />\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Info */}\r\n                <div className=\"product-info-section\">\r\n                    <div className=\"product-category\">{catLabel(product.category)}</div>\r\n                    <h1 className=\"product-title\">{product.title}</h1>\r\n\r\n                    <div className=\"product-rating\">\r\n                        {renderStars(averageRating)}\r\n                        <span className=\"rating-text\">\r\n                            {averageRating > 0 ? averageRating.toFixed(1) : \"Sin calificar\"}\r\n                            {typeof product.reviewsCount === \"number\" ? ` (${product.reviewsCount} rese√±as)` : \"\"}\r\n                        </span>\r\n                    </div>\r\n\r\n                    <div className=\"product-price-main\">{fmtCRC(product.price)}</div>\r\n\r\n                    <div className=\"product-description\">\r\n                        <h3>Descripci√≥n</h3>\r\n                        <p>{product.description || \"Sin descripci√≥n\"}</p>\r\n                    </div>\r\n\r\n                    <div className=\"product-purchase\">\r\n                        <div className=\"quantity-section\">\r\n                            <label>Cantidad:</label>\r\n                            <div className=\"quantity-controls\">\r\n                                <button onClick={() => setQuantity(Math.max(1, quantity - 1))} className=\"quantity-btn\"><i className=\"fa fa-minus\" /></button>\r\n                                <span className=\"quantity-display\">{quantity}</span>\r\n                                <button onClick={() => setQuantity(quantity + 1)} className=\"quantity-btn\"><i className=\"fa fa-plus\" /></button>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div className=\"purchase-actions\">\r\n                            <button className={`btn-add-to-cart ${addedToCart ? \"added\" : \"\"}`} onClick={handleAddToCart} disabled={product.stock <= 0}>\r\n                                {addedToCart ? (<><i className=\"fa fa-check\" /> ¬°Agregado!</>) : (<><i className=\"fa fa-shopping-cart\" /> Agregar al carrito</>)}\r\n                            </button>\r\n                            <button className=\"btn-buy-now\" disabled={product.stock <= 0} onClick={() => { handleAddToCart(); setTimeout(() => navigate(\"/cart\"), 400); }}>\r\n                                <i className=\"fa fa-bolt\" /> Comprar ahora\r\n                            </button>\r\n                        </div>\r\n\r\n                        {/* Evaluar (solo compradores) */}\r\n                        {user && user.userType === \"buyer\" && (\r\n                            <button className=\"btn-review-product\" onClick={() => setShowReviewForm(true)}>\r\n                                <i className=\"fa fa-star\" /> Evaluar Producto\r\n                            </button>\r\n                        )}\r\n                    </div>\r\n\r\n                    {/* üè™ Ver tienda completa del vendedor */}\r\n                    {seller && (\r\n                        <div className=\"seller-info-cta\" style={{ marginTop: 16 }}>\r\n                            <Link to={`/shop?vendor=${seller.id}`} className=\"btn-view-store\">\r\n                                <i className=\"fa fa-eye\" /> Ver tienda de {seller.businessName || seller.name}\r\n                            </Link>\r\n                        </div>\r\n                    )}\r\n\r\n                    <div className=\"product-features\">\r\n                        <div className=\"feature\"><i className=\"fa fa-truck\" /><span>Env√≠o a todo Costa Rica</span></div>\r\n                        <div className=\"feature\"><i className=\"fa fa-shield-alt\" /><span>Garant√≠a de calidad artesanal</span></div>\r\n                        <div className=\"feature\"><i className=\"fa fa-heart\" /><span>Hecho con amor por artesanos locales</span></div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Rese√±as */}\r\n            <div className=\"product-reviews-section\">\r\n                <h2>‚≠ê Rese√±as del Producto</h2>\r\n                {reviews.length > 0 ? (\r\n                    <div className=\"reviews-list\">\r\n                        {reviews.slice(0, 20).map((rv) => (\r\n                            <div key={rv._id} className=\"review-item\">\r\n                                <div className=\"review-header\">\r\n                                    <div className=\"reviewer-info\">\r\n                                        {rv.userId?.avatar ? (\r\n                                            <img src={rv.userId.avatar} alt={rv.userId?.name} className=\"review-avatar\" />\r\n                                        ) : (\r\n                                            <i className=\"fa fa-user-circle\" />\r\n                                        )}\r\n                                        <span>{rv.userId?.name || \"Usuario\"}</span>\r\n                                    </div>\r\n                                    <div className=\"review-rating\">{renderStars(rv.rating || 0)}</div>\r\n                                </div>\r\n                                <div className=\"review-date\">{new Date(rv.createdAt).toLocaleDateString(\"es-CR\")}</div>\r\n                                {rv.comment && <div className=\"review-comment\">{rv.comment}</div>}\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                ) : (\r\n                    <p className=\"no-reviews\">A√∫n no hay rese√±as para este producto.</p>\r\n                )}\r\n            </div>\r\n\r\n            {/* Modal rese√±a */}\r\n            {showReviewForm && (\r\n                <div className=\"modal-overlay\" onClick={() => setShowReviewForm(false)}>\r\n                    <div className=\"modal-content\" onClick={(e) => e.stopPropagation()}>\r\n                        <div className=\"modal-header\">\r\n                            <h2>Evaluar Producto</h2>\r\n                            <button onClick={() => setShowReviewForm(false)} className=\"modal-close\"><i className=\"fa fa-times\" /></button>\r\n                        </div>\r\n                        <div className=\"modal-body\">\r\n                            <div className=\"rating-section\">\r\n                                <label>Calificaci√≥n:</label>\r\n                                {renderStars(userRating, true, setUserRating)}\r\n                            </div>\r\n                            <div className=\"comment-section\">\r\n                                <label>Comentario (opcional):</label>\r\n                                <textarea value={reviewComment} onChange={(e) => setReviewComment(e.target.value)} placeholder=\"Contanos tu experiencia‚Ä¶\" rows={4} />\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"modal-footer\">\r\n                            <button onClick={() => setShowReviewForm(false)} className=\"btn-cancel\">Cancelar</button>\r\n                            <button onClick={handleSubmitReview} className=\"btn-submit\" disabled={userRating === 0}>Enviar Rese√±a</button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </main>\r\n    );\r\n};\r\n\r\nexport default ProductPage;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}